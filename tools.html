
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tools package &#8212; crispy 0.2.0 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="shortcut icon" href="_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Process multiple IFS images in parallel" href="notebooks/MultiProcExample.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="_static/copybutton.js"></script>


  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="index.html"><span id="logotext1">CRIS</span><span id="logotext2">PY</span><span id="logotext3"> - IFS Simulator</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="genindex.html">Index</a></li>
    <li><a title="Module Index" href="py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="notebooks/MultiProcExample.html" title="Process multiple IFS images in parallel">
	  &laquo; previous
	</a>
	
      </li>
      <li>
	<a href="index.html">crispy 0.2.0 documentation</a>
	 &#187;
      </li>
      
      <li>tools package</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tools-package">
<h1>tools package<a class="headerlink" href="#tools-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tools.detector">
<span id="tools-detector-module"></span><h2>tools.detector module<a class="headerlink" href="#module-tools.detector" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.detector.averageDetectorReadout">
<code class="descclassname">tools.detector.</code><code class="descname">averageDetectorReadout</code><span class="sig-paren">(</span><em>par</em>, <em>filelist</em>, <em>detectorFolderOut</em>, <em>suffix='detector'</em>, <em>offaxis=None</em>, <em>averageDivide=False</em>, <em>factor=1.0</em>, <em>zodi=None</em>, <em>forced_inttime=None</em>, <em>forced_tottime=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detector.html#averageDetectorReadout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detector.averageDetectorReadout" title="Permalink to this definition">¶</a></dt>
<dd><p>Process a list of files and creates individual detector readouts
If we want only one file, we can just make a list of 1</p>
</dd></dl>

<dl class="function">
<dt id="tools.detector.averageDetectorReadoutParallel">
<code class="descclassname">tools.detector.</code><code class="descname">averageDetectorReadoutParallel</code><span class="sig-paren">(</span><em>par</em>, <em>filelist</em>, <em>detectorFolderOut</em>, <em>suffix='detector'</em>, <em>offaxis=None</em>, <em>averageDivide=False</em>, <em>factor=1.0</em>, <em>zodi=None</em>, <em>forced_inttime=None</em>, <em>forced_tottime=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detector.html#averageDetectorReadoutParallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detector.averageDetectorReadoutParallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Process a list of files and creates individual detector readouts
If we want only one file, we can just make a list of 1</p>
</dd></dl>

<dl class="function">
<dt id="tools.detector.calculateDark">
<code class="descclassname">tools.detector.</code><code class="descname">calculateDark</code><span class="sig-paren">(</span><em>par</em>, <em>filelist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detector.html#calculateDark"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detector.calculateDark" title="Permalink to this definition">¶</a></dt>
<dd><p>Process a series of dark frames to get an estimate of the dark current frame that matches the exposures.</p>
</dd></dl>

<dl class="function">
<dt id="tools.detector.multipleReadouts">
<code class="descclassname">tools.detector.</code><code class="descname">multipleReadouts</code><span class="sig-paren">(</span><em>par</em>, <em>filename</em>, <em>detectorFolderOut</em>, <em>suffix='detector'</em>, <em>offaxis=None</em>, <em>averageDivide=False</em>, <em>factor=1.0</em>, <em>zodi=None</em>, <em>forced_inttime=None</em>, <em>forced_tottime=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detector.html#multipleReadouts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detector.multipleReadouts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.detector.photonCounting">
<code class="descclassname">tools.detector.</code><code class="descname">photonCounting</code><span class="sig-paren">(</span><em>average</em>, <em>EMGain=1.0</em>, <em>RN=0.0</em>, <em>PCbias=0.0</em>, <em>threshold=6</em>, <em>poisson=True</em>, <em>EMStats=True</em>, <em>PCmode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detector.html#photonCounting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detector.photonCounting" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.detector.readDetector">
<code class="descclassname">tools.detector.</code><code class="descname">readDetector</code><span class="sig-paren">(</span><em>par</em>, <em>IFSimage</em>, <em>inttime=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detector.html#readDetector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detector.readDetector" title="Permalink to this definition">¶</a></dt>
<dd><p>Read noise, CIC, dark current; NO TRAPS
Input is IFSimage in average photons per second
Quantum efficiency considerations are already taken care of when
generating IFSimage images</p>
</dd></dl>

<dl class="function">
<dt id="tools.detector.readoutPhotonFluxMapWFIRST">
<code class="descclassname">tools.detector.</code><code class="descname">readoutPhotonFluxMapWFIRST</code><span class="sig-paren">(</span><em>fluxMap</em>, <em>tottime</em>, <em>inttime=None</em>, <em>QE=1.0</em>, <em>darkBOL=0.00014</em>, <em>darkEOL=0.00028</em>, <em>CIC=0.01</em>, <em>eff=1.0</em>, <em>EMGain=2500.0</em>, <em>RN=100.0</em>, <em>PCbias=1000.0</em>, <em>threshold=6.0</em>, <em>lifefraction=0.0</em>, <em>dqeKnee=0.858</em>, <em>dqeFluxSlope=3.24</em>, <em>dqeKneeFlux=0.089</em>, <em>nonoise=False</em>, <em>poisson=True</em>, <em>EMStats=True</em>, <em>PCmode=True</em>, <em>PCcorrect=False</em>, <em>normalize=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detector.html#readoutPhotonFluxMapWFIRST"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detector.readoutPhotonFluxMapWFIRST" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.detector.rebinDetector">
<code class="descclassname">tools.detector.</code><code class="descname">rebinDetector</code><span class="sig-paren">(</span><em>par</em>, <em>finalFrame</em>, <em>clip=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detector.html#rebinDetector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detector.rebinDetector" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebins the dense detector map with the correct scaling while conserving flux.
This also works with non-integer ratios.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameter instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>finalFrame</strong> : 2D ndarray</p>
<blockquote>
<div><p>Dense detector map to be rebinned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>detectorFrame</strong> : 2D array</p>
<blockquote class="last">
<div><p>Return the detector frame with correct pixel scale.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.detutils">
<span id="tools-detutils-module"></span><h2>tools.detutils module<a class="headerlink" href="#module-tools.detutils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.detutils.frebin">
<code class="descclassname">tools.detutils.</code><code class="descname">frebin</code><span class="sig-paren">(</span><em>array</em>, <em>shape</em>, <em>total=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detutils.html#frebin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detutils.frebin" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that performs flux-conservative
rebinning of an array. Found at <a class="reference external" href="https://github.com/benjaminpope/pysco/blob/master/frebin.py">https://github.com/benjaminpope/pysco/blob/master/frebin.py</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>array: ndarray</strong></p>
<blockquote>
<div><p>Numpy array to be rebinned</p>
</div></blockquote>
<p><strong>shape: tuple</strong></p>
<blockquote>
<div><p>(x,y) of new array size
total: Boolean</p>
<blockquote>
<div><p>when True flux is conserved</p>
</div></blockquote>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>——-</strong></p>
<blockquote class="last">
<div><p>new_array: new rebinned array with dimensions: shape</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.detutils.rebin">
<code class="descclassname">tools.detutils.</code><code class="descname">rebin</code><span class="sig-paren">(</span><em>a</em>, <em>shape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/detutils.html#rebin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.detutils.rebin" title="Permalink to this definition">¶</a></dt>
<dd><p>Resizes a 2d array by averaging or repeating elements,
new dimensions must be integral factors of original dimensions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> : array_like</p>
<blockquote>
<div><p>Input array.</p>
</div></blockquote>
<p><strong>new_shape</strong> : tuple of int</p>
<blockquote>
<div><p>Shape of the output array (y, x)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rebinned_array</strong> : ndarray</p>
<blockquote class="last">
<div><p>If the new shape is smaller of the input array, the data are averaged,
if the new shape is bigger array elements are repeated</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.image">
<span id="tools-image-module"></span><h2>tools.image module<a class="headerlink" href="#module-tools.image" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="tools.image.Image">
<em class="property">class </em><code class="descclassname">tools.image.</code><code class="descname">Image</code><span class="sig-paren">(</span><em>filename=''</em>, <em>data=None</em>, <em>ivar=None</em>, <em>header=None</em>, <em>extraheader=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/image.html#Image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.image.Image" title="Permalink to this definition">¶</a></dt>
<dd><p>Image is the basic class for images</p>
<p>self.data, self.ivar, and self.header should be numpy ndarrays,
which can be read from and written to a fits file with the load
and write methods.  If not ndarrays, they should be None.</p>
<p>Image may be initialized with the name of the raw file to read,
through a call to Image.load().</p>
<dl class="method">
<dt id="tools.image.Image.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>outfilename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/image.html#Image.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.image.Image.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the first HDU with data from filename into self.data, and
HDU[0].header into self.header.  If there is more than one HDU
with data, attempt to read the second HDU with data into
self.ivar.</p>
</dd></dl>

<dl class="method">
<dt id="tools.image.Image.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>outfilename</em>, <em>clobber=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/image.html#Image.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.image.Image.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a primary HDU using self.data and self.header, and
attempts to write to outfilename.  If self.ivar is not None,
append self.ivar as a second HDU before writing to a file.
clobber is provided as a keyword to fits.HDUList.writeto.</p>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="tools.image.log">
<code class="descclassname">tools.image.</code><code class="descname">log</code><em class="property"> = &lt;tools.initLogger.crispyLogger object&gt;</em><a class="headerlink" href="#tools.image.log" title="Permalink to this definition">¶</a></dt>
<dd><p>most of this code is due to Tim Brandt</p>
</dd></dl>

</div>
<div class="section" id="module-tools.imgtools">
<span id="tools-imgtools-module"></span><h2>tools.imgtools module<a class="headerlink" href="#module-tools.imgtools" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.imgtools.bowtie">
<code class="descclassname">tools.imgtools.</code><code class="descname">bowtie</code><span class="sig-paren">(</span><em>image</em>, <em>xc</em>, <em>yc</em>, <em>openingAngle</em>, <em>clocking</em>, <em>IWApix</em>, <em>OWApix</em>, <em>export='bowtie'</em>, <em>twomasks=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/imgtools.html#bowtie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.imgtools.bowtie" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates one or two binary mask for a shaped pupil bowtie mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>image: 2D ndarray</strong></p>
<blockquote>
<div><p>Image to which the mask needs to be applied</p>
</div></blockquote>
<p><strong>xc: int</strong></p>
<blockquote>
<div><p>X coordinate of center of bowtie</p>
</div></blockquote>
<p><strong>yc: int</strong></p>
<blockquote>
<div><p>Y coordinate of center of bowtie</p>
</div></blockquote>
<p><strong>openingAngle: float</strong></p>
<blockquote>
<div><p>Angle in degrees representing the opening angle of the bowtie mask</p>
</div></blockquote>
<p><strong>clocking: float</strong></p>
<blockquote>
<div><p>Angle of rotation of the mask in degrees</p>
</div></blockquote>
<p><strong>IWApix: float</strong></p>
<blockquote>
<div><p>Radius in pixels corresponding to the inner working angle of the mask</p>
</div></blockquote>
<p><strong>OWApix: float</strong></p>
<blockquote>
<div><p>Radius in pixels corresponding to the outer working angle of the mask</p>
</div></blockquote>
<p><strong>export: boolean</strong></p>
<blockquote>
<div><p>Whether to export the bowtie or not</p>
</div></blockquote>
<p><strong>twomasks: boolean</strong></p>
<blockquote>
<div><p>If True, returns two masks, one for each side of the bowtie
If False, returns one single mask</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mask: 2D ndarrays of int</p>
<blockquote>
<div><p>Bowtie mask with 1 inside the mask, zero everywhere else.</p>
</div></blockquote>
<p>mask2: 2D ndarrays of int</p>
<blockquote class="last">
<div><p>If twomasks is True, mask and mask2 are the two sides of the bowtie.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.imgtools.circularMask">
<code class="descclassname">tools.imgtools.</code><code class="descname">circularMask</code><span class="sig-paren">(</span><em>image</em>, <em>radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/imgtools.html#circularMask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.imgtools.circularMask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.imgtools.gen_bad_pix_mask">
<code class="descclassname">tools.imgtools.</code><code class="descname">gen_bad_pix_mask</code><span class="sig-paren">(</span><em>image</em>, <em>filsize=3</em>, <em>threshold=5.0</em>, <em>return_smoothed_image=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/imgtools.html#gen_bad_pix_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.imgtools.gen_bad_pix_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify and mask bad pixels using median filter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>image: 2D ndarray</strong></p>
<blockquote>
<div><p>Image to clean</p>
</div></blockquote>
<p><strong>filsize: int</strong></p>
<blockquote>
<div><p>Size of median filter in pixels</p>
</div></blockquote>
<p><strong>threshold: float</strong></p>
<blockquote>
<div><p>Threshold in terms of standard deviations</p>
</div></blockquote>
<p><strong>return_smoothed_image: boolean</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">goodpix: 2D int ndarray</p>
<blockquote>
<div><p>Good pixel mask. 1 where pixel is good</p>
</div></blockquote>
<p class="last">image_sm: 2D ndarray, if return_smoothed_image</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.imgtools.gen_lenslet_flat">
<code class="descclassname">tools.imgtools.</code><code class="descname">gen_lenslet_flat</code><span class="sig-paren">(</span><em>BBcube</em>, <em>nsig=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/imgtools.html#gen_lenslet_flat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.imgtools.gen_lenslet_flat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.imgtools.scale2imgs">
<code class="descclassname">tools.imgtools.</code><code class="descname">scale2imgs</code><span class="sig-paren">(</span><em>target</em>, <em>ref</em>, <em>bowtie_mask</em>, <em>returndiff=True</em>, <em>returnest=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/imgtools.html#scale2imgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.imgtools.scale2imgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the slice-by-slice best-fit scale factor between two images.
Optionally returns the difference between the two.
Images can be cubes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>bowtie_mask: 2D ndarray</strong></p>
<blockquote>
<div><p>Bowtie mask</p>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>——-</strong></p>
<p><strong>coefs: float array</strong></p>
<blockquote>
<div><p>Coefficient(s) of the best fit between the two images or cubes</p>
</div></blockquote>
<p><strong>diff: ndarray</strong></p>
<blockquote class="last">
<div><p>Same shape as input, residual difference img1*scale-img2.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.imgtools.subtract_mean">
<code class="descclassname">tools.imgtools.</code><code class="descname">subtract_mean</code><span class="sig-paren">(</span><em>cube</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/imgtools.html#subtract_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.imgtools.subtract_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>subtract the mean of the cube slice by slice</p>
</dd></dl>

</div>
<div class="section" id="module-tools.initLogger">
<span id="tools-initlogger-module"></span><h2>tools.initLogger module<a class="headerlink" href="#module-tools.initLogger" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.initLogger.addFileHandler">
<code class="descclassname">tools.initLogger.</code><code class="descname">addFileHandler</code><span class="sig-paren">(</span><em>log</em>, <em>lvl=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#addFileHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.addFileHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will add a file handler to a log with the provided level.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>log (crispyLogger object): A crispyLogger object that was freshly</dt>
<dd>instantiated.</dd>
<dt>lvl (int): The severity level of messages printed to the file with</dt>
<dd>the file handler, default = 1.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tools.initLogger.addFitsStyleHandler">
<code class="descclassname">tools.initLogger.</code><code class="descname">addFitsStyleHandler</code><span class="sig-paren">(</span><em>log</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#addFitsStyleHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.addFitsStyleHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will add a file handler with a string format ideal for
directly loading into a FITS header.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>log (crispyLogger object): A crispyLogger object that was freshly</dt>
<dd>instantiated.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tools.initLogger.addStreamHandler">
<code class="descclassname">tools.initLogger.</code><code class="descname">addStreamHandler</code><span class="sig-paren">(</span><em>log</em>, <em>lvl=20</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#addStreamHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.addStreamHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will add a stream handler to a log with the provided level.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>log (crispyLogger object): A crispyLogger object that was freshly</dt>
<dd>instantiated.</dd>
<dt>lvl (int): The severity level of messages printed to the screen with</dt>
<dd>the stream handler, default = 20.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="tools.initLogger.crispyLogger">
<em class="property">class </em><code class="descclassname">tools.initLogger.</code><code class="descname">crispyLogger</code><span class="sig-paren">(</span><em>name</em>, <em>level=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">logging.Logger</span></code></a></p>
<p>This is the advanced logging object used for crispy.
It is almost a carbon copy of the CHARIS DRP logger routine.
It inherits from the standard
Python library ‘logging’ and provides added features.
The default log level for the output file will be 1, ie ALL messages;
while the default for the screen will be INFO, and can be changed easily
using the setStreamLevel(lvl) member function.</p>
<p>Initialize the logger with a name and an optional level.</p>
<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.MAINCRITICAL">
<code class="descname">MAINCRITICAL</code><em class="property"> = 80</em><a class="headerlink" href="#tools.initLogger.crispyLogger.MAINCRITICAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.MAINDEBUG">
<code class="descname">MAINDEBUG</code><em class="property"> = 60</em><a class="headerlink" href="#tools.initLogger.crispyLogger.MAINDEBUG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.MAINERROR">
<code class="descname">MAINERROR</code><em class="property"> = 75</em><a class="headerlink" href="#tools.initLogger.crispyLogger.MAINERROR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.MAININFO">
<code class="descname">MAININFO</code><em class="property"> = 65</em><a class="headerlink" href="#tools.initLogger.crispyLogger.MAININFO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.MAINWARNING">
<code class="descname">MAINWARNING</code><em class="property"> = 70</em><a class="headerlink" href="#tools.initLogger.crispyLogger.MAINWARNING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.PRIMCRITICAL">
<code class="descname">PRIMCRITICAL</code><em class="property"> = 55</em><a class="headerlink" href="#tools.initLogger.crispyLogger.PRIMCRITICAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.PRIMDEBUG">
<code class="descname">PRIMDEBUG</code><em class="property"> = 35</em><a class="headerlink" href="#tools.initLogger.crispyLogger.PRIMDEBUG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.PRIMERROR">
<code class="descname">PRIMERROR</code><em class="property"> = 49</em><a class="headerlink" href="#tools.initLogger.crispyLogger.PRIMERROR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.PRIMINFO">
<code class="descname">PRIMINFO</code><em class="property"> = 39</em><a class="headerlink" href="#tools.initLogger.crispyLogger.PRIMINFO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.PRIMWARNING">
<code class="descname">PRIMWARNING</code><em class="property"> = 45</em><a class="headerlink" href="#tools.initLogger.crispyLogger.PRIMWARNING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.SUMMARY">
<code class="descname">SUMMARY</code><em class="property"> = 5</em><a class="headerlink" href="#tools.initLogger.crispyLogger.SUMMARY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.TOOLCRITICAL">
<code class="descname">TOOLCRITICAL</code><em class="property"> = 29</em><a class="headerlink" href="#tools.initLogger.crispyLogger.TOOLCRITICAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.TOOLDEBUG">
<code class="descname">TOOLDEBUG</code><em class="property"> = 9</em><a class="headerlink" href="#tools.initLogger.crispyLogger.TOOLDEBUG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.TOOLERROR">
<code class="descname">TOOLERROR</code><em class="property"> = 25</em><a class="headerlink" href="#tools.initLogger.crispyLogger.TOOLERROR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.TOOLINFO">
<code class="descname">TOOLINFO</code><em class="property"> = 15</em><a class="headerlink" href="#tools.initLogger.crispyLogger.TOOLINFO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.initLogger.crispyLogger.TOOLWARNING">
<code class="descname">TOOLWARNING</code><em class="property"> = 19</em><a class="headerlink" href="#tools.initLogger.crispyLogger.TOOLWARNING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.maincritical">
<code class="descname">maincritical</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=80</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.maincritical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.maincritical" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.maindebug">
<code class="descname">maindebug</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=60</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.maindebug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.maindebug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.mainerror">
<code class="descname">mainerror</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=75</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.mainerror"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.mainerror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.maininfo">
<code class="descname">maininfo</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=65</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.maininfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.maininfo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.mainwarning">
<code class="descname">mainwarning</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=70</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.mainwarning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.mainwarning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.primcritical">
<code class="descname">primcritical</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=55</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.primcritical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.primcritical" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.primdebug">
<code class="descname">primdebug</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=35</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.primdebug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.primdebug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.primerror">
<code class="descname">primerror</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=49</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.primerror"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.primerror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.priminfo">
<code class="descname">priminfo</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=39</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.priminfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.priminfo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.primwarning">
<code class="descname">primwarning</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=45</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.primwarning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.primwarning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.setStreamLevel">
<code class="descname">setStreamLevel</code><span class="sig-paren">(</span><em>lvl=20</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.setStreamLevel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.setStreamLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Set/change the level for the stream handler for a logging object.
Any file handlers will be left alone.
All messages of a higher severity level than ‘lvl’ will be printed
to the screen.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>lvl (int): The severity level of messages printed to the screen with</dt>
<dd>the stream handler, default = 20.</dd>
</dl>
</dd>
</dl>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="12%" />
<col width="39%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Standard Levels</th>
<th class="head" colspan="2">New Levels</th>
</tr>
<tr class="row-even"><th class="head">Name</th>
<th class="head">Level</th>
<th class="head">Name</th>
<th class="head">Level</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>CRITICAL</td>
<td>50</td>
<td>MAINCRITICAL</td>
<td>80</td>
</tr>
<tr class="row-even"><td>ERROR</td>
<td>40</td>
<td>MAINERROR</td>
<td>75</td>
</tr>
<tr class="row-odd"><td>WARNING</td>
<td>30</td>
<td>MAINWARNING</td>
<td>70</td>
</tr>
<tr class="row-even"><td>INFO</td>
<td>20</td>
<td>MAININFO</td>
<td>65</td>
</tr>
<tr class="row-odd"><td>DEBUG</td>
<td>10</td>
<td>MAINDEBUG</td>
<td>60</td>
</tr>
<tr class="row-even"><td>NOTSET</td>
<td>0</td>
<td>PRIMCRITICAL</td>
<td>55</td>
</tr>
<tr class="row-odd"><td rowspan="10">&#160;</td>
<td rowspan="10">&#160;</td>
<td>PRIMERROR</td>
<td>49</td>
</tr>
<tr class="row-even"><td>PRIMWARNING</td>
<td>45</td>
</tr>
<tr class="row-odd"><td>PRIMINFO</td>
<td>39</td>
</tr>
<tr class="row-even"><td>PRIMDEBUG</td>
<td>35</td>
</tr>
<tr class="row-odd"><td>TOOLCRITICAL</td>
<td>29</td>
</tr>
<tr class="row-even"><td>TOOLERROR</td>
<td>25</td>
</tr>
<tr class="row-odd"><td>TOOLWARNING</td>
<td>19</td>
</tr>
<tr class="row-even"><td>TOOLINFO</td>
<td>15</td>
</tr>
<tr class="row-odd"><td>TOOLDEBUG</td>
<td>9</td>
</tr>
<tr class="row-even"><td>SUMMARY</td>
<td>5</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.summary">
<code class="descname">summary</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=5</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.summary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.toolcritical">
<code class="descname">toolcritical</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=29</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.toolcritical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.toolcritical" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.tooldebug">
<code class="descname">tooldebug</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=9</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.tooldebug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.tooldebug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.toolerror">
<code class="descname">toolerror</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=25</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.toolerror"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.toolerror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.toolinfo">
<code class="descname">toolinfo</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=15</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.toolinfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.toolinfo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.initLogger.crispyLogger.toolwarning">
<code class="descname">toolwarning</code><span class="sig-paren">(</span><em>msg</em>, <em>lvl=19</em>, <em>*args</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#crispyLogger.toolwarning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.crispyLogger.toolwarning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.initLogger.getLogger">
<code class="descclassname">tools.initLogger.</code><code class="descname">getLogger</code><span class="sig-paren">(</span><em>name='generalLoggerName'</em>, <em>lvl=20</em>, <em>addFH=True</em>, <em>addSH=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#getLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.getLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>This will either return the logging object already
instantiated, or instantiate a new one and return it.
<strong>Use this function to both create and return any logger</strong> to avoid
accidentally adding additional handlers by using the setUpLogger function
instead.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>name (str): The name for the logging object and</dt>
<dd>name.log will be the output file written to disk.</dd>
<dt>lvl (int): The severity level of messages printed to the screen with</dt>
<dd>the stream handler, default = 20.</dd>
<dt>addFH (boolean): Add a file handler to this logger?  Default severity</dt>
<dd>level for it will be 1, and it will be named following
name+’.log’.  Default = True.</dd>
<dt>addSH (boolean): Add a stream handler to this logger? Severity set with</dt>
<dd>the lvl argument.  Default = True.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>log (CharisLogger object): A CharisLogger object that was either</dt>
<dd>freshly instantiated or determined to
already exist, then returned.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tools.initLogger.setUpLogger">
<code class="descclassname">tools.initLogger.</code><code class="descname">setUpLogger</code><span class="sig-paren">(</span><em>name='generalLoggerName'</em>, <em>lvl=20</em>, <em>addFH=True</em>, <em>addSH=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/initLogger.html#setUpLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.initLogger.setUpLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is utilized by getLogger to set up a new logging object.
It will have the default name ‘generalLoggerName’ and stream handler level
of 20 unless redefined in the function call.
NOTE:
If a file handler is added, it will have the lowest severity level by
default (Currently no need for changing this setting, so it will stay
this way for now).  Remember that any messages will be passed up to any
parent loggers, so children do not always need their own file handler.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>name (str): The name for the logging object and</dt>
<dd>name.log will be the output file written to disk.</dd>
<dt>lvl (int): The severity level of messages printed to the screen with</dt>
<dd>the stream handler, default = 20.</dd>
<dt>addFH (boolean): Add a file handler to this logger?  Default severity</dt>
<dd>level for it will be 1, and it will be named following
name+’.log’.  Default = True.</dd>
<dt>addSH (boolean): Add a stream handler to this logger? Severity set with</dt>
<dd>the lvl argument.  Default = True.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>log (crispyLogger object): A crispyLogger object that was freshly</dt>
<dd>instantiated.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-tools.inputScene">
<span id="tools-inputscene-module"></span><h2>tools.inputScene module<a class="headerlink" href="#module-tools.inputScene" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.inputScene.Jy_to_photons">
<code class="descclassname">tools.inputScene.</code><code class="descname">Jy_to_photons</code><span class="sig-paren">(</span><em>cube_Jy</em>, <em>wavlist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/inputScene.html#Jy_to_photons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.inputScene.Jy_to_photons" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cube_Jy: 3D datacube in Jy</strong></p>
<blockquote>
<div><p>wavlist: 1D array with wavelengths in microns</p>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>——-</strong></p>
<blockquote class="last">
<div><p>hc: 3D haystacks cube in photons/m2/um/s</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.inputScene.adjust_krist_header">
<code class="descclassname">tools.inputScene.</code><code class="descname">adjust_krist_header</code><span class="sig-paren">(</span><em>cube</em>, <em>lamc</em>, <em>pixsize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/inputScene.html#adjust_krist_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.inputScene.adjust_krist_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Force a different central wavelength, assuming that everything is wavelength-independent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cube: 3D float array</strong></p>
<blockquote>
<div><p>Input cube from J. Krist</p>
</div></blockquote>
<p><strong>lamc: float</strong></p>
<blockquote>
<div><p>Central wavelength to override in nm</p>
</div></blockquote>
<p><strong>pixsize: float</strong></p>
<blockquote class="last">
<div><p>Pixel scale at central wavelength to override (in lambda/D)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.inputScene.calc_contrast">
<code class="descclassname">tools.inputScene.</code><code class="descname">calc_contrast</code><span class="sig-paren">(</span><em>wavelist</em>, <em>distance</em>, <em>radius</em>, <em>filename</em>, <em>albedo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/inputScene.html#calc_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.inputScene.calc_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>Function calcContrast</p>
<p>Returns the flux ratio Fplanet/Fstar at given wavelengths.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>wavelist</strong> :   1D array, list</p>
<blockquote>
<div><p>Array of wavelengths in nm at which the contrast is computed.</p>
</div></blockquote>
<p><strong>distance</strong> : float</p>
<blockquote>
<div><p>Distance in AU between the planet and the star</p>
</div></blockquote>
<p><strong>radius: float</strong></p>
<blockquote>
<div><p>Radius of planet in units of Jupiter radii</p>
</div></blockquote>
<p><strong>filename: string</strong></p>
<blockquote>
<div><p>Two-column file with first column as the wavelength in microns, second column is the geometrical albedo</p>
</div></blockquote>
<p><strong>albedo: float</strong></p>
<blockquote>
<div><p>If None, then the albedo is given by the contents of the text file. If not None, the geometrical albedo given
in the text file is normalized to have its maximum within the wavelist range to be albedo.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>vals</strong> : 1D array</p>
<blockquote class="last">
<div><p>Array of flux ratio at the desired wavelengths.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.inputScene.calc_contrast_Bijan">
<code class="descclassname">tools.inputScene.</code><code class="descname">calc_contrast_Bijan</code><span class="sig-paren">(</span><em>wavelist</em>, <em>albedo=0.28</em>, <em>radius=1.27</em>, <em>dist=3.6</em>, <em>planet_type='Jupiter'</em>, <em>abundance=1</em>, <em>distance=5</em>, <em>phase=90</em>, <em>folder='/Users/mrizzo/Science/Haystacks/Cahoy_Spectra/albedo_spectra/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/inputScene.html#calc_contrast_Bijan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.inputScene.calc_contrast_Bijan" title="Permalink to this definition">¶</a></dt>
<dd><p>Function calc_contrast_Bijan (obsolete)</p>
</dd></dl>

<dl class="function">
<dt id="tools.inputScene.convert_krist_cube">
<code class="descclassname">tools.inputScene.</code><code class="descname">convert_krist_cube</code><span class="sig-paren">(</span><em>cubeshape</em>, <em>lamlist</em>, <em>star_T</em>, <em>star_Vmag</em>, <em>tel_area</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/inputScene.html#convert_krist_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.inputScene.convert_krist_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Function convert_krist_cube</p>
<p>This function calculates the number of photons per second
entering the WFIRST obscured aperture, given the star <code class="xref py py-obj docutils literal"><span class="pre">Vmag</span></code> and its temperature
for each slice of the input cube
This was only tested with John Krist’s cubes and his normalization.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cubeshape: tuple</strong></p>
<blockquote>
<div><p>Indicates the shape of the cube that needs to be multiplied</p>
</div></blockquote>
<p><strong>lamlist: 1D array</strong></p>
<blockquote>
<div><p>Wavelength array in nm corresponding to the cube slices</p>
</div></blockquote>
<p><strong>star_T: float</strong></p>
<blockquote>
<div><p>Stellar temperature in K</p>
</div></blockquote>
<p><strong>star_Vmag: float</strong></p>
<blockquote>
<div><p>Stellar magnitude in V band</p>
</div></blockquote>
<p><strong>tel_area: units.m**2</strong></p>
<blockquote>
<div><p>Area of telescope in units of units.m**2</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">newcube: 3D array</p>
<blockquote class="last">
<div><p>Cube that multiplies an input normalized cube from John Krist to turn it into units
of photons/s/nm/pixel. Each slice from the product cube subsequently needs to be multiplied by the
bandwidth of each slice to determine the photons/s/pixel incident on the telescope</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.inputScene.haystacks_to_photons">
<code class="descclassname">tools.inputScene.</code><code class="descname">haystacks_to_photons</code><span class="sig-paren">(</span><em>haystacks_hdu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/inputScene.html#haystacks_to_photons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.inputScene.haystacks_to_photons" title="Permalink to this definition">¶</a></dt>
<dd><p>Function haystacks_to_photons</p>
<p>This function converts a Haystacks hdu in Jy/pixels to photons/s/nm/m^2/pixel
and returns a full cube</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cube: haystacks_hdu</strong></p>
<blockquote>
<div><p>Haystacks HDU</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">hc: ndarray</p>
<blockquote>
<div><p>Converted cube in ph/s/um/m2</p>
</div></blockquote>
<p class="last">lamlist: wavelength array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.inputScene.zodi_cube">
<code class="descclassname">tools.inputScene.</code><code class="descname">zodi_cube</code><span class="sig-paren">(</span><em>krist_cube</em>, <em>area_per_pixel</em>, <em>absmag</em>, <em>Vstarmag</em>, <em>zodi_surfmag</em>, <em>exozodi_surfmag</em>, <em>distAU</em>, <em>t_zodi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/inputScene.html#zodi_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.inputScene.zodi_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>(obsolete)</p>
</dd></dl>

</div>
<div class="section" id="module-tools.lenslet">
<span id="tools-lenslet-module"></span><h2>tools.lenslet module<a class="headerlink" href="#module-tools.lenslet" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.lenslet.processImagePlane">
<code class="descclassname">tools.lenslet.</code><code class="descname">processImagePlane</code><span class="sig-paren">(</span><em>par</em>, <em>imagePlane</em>, <em>noRot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/lenslet.html#processImagePlane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.lenslet.processImagePlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Function processImagePlane</p>
<p>Rotates an image or slice, and rebins in a flux-conservative way
on an array of lenslets, using the plate scale provided in par.pixperlenslet.
Each pixel represents the flux within a lenslet. Starts by padding the original
image to avoid cropping edges when rotating. This step necessarily involves an
interpolation, so one needs to be cautious.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameters instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>imagePlane</strong> : 2D array</p>
<blockquote>
<div><p>Input slice to IFS sim, first dimension of data is wavelength</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>imagePlaneRot</strong> : 2D array</p>
<blockquote class="last">
<div><p>Rotated image plane on same sampling as original.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.lenslet.propagateLenslets">
<code class="descclassname">tools.lenslet.</code><code class="descname">propagateLenslets</code><span class="sig-paren">(</span><em>par</em>, <em>imageplane</em>, <em>lam1</em>, <em>lam2</em>, <em>hires_arrs=None</em>, <em>lam_arr=None</em>, <em>upsample=3</em>, <em>nlam=10</em>, <em>npix=13</em>, <em>order=3</em>, <em>x0=0.3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/lenslet.html#propagateLenslets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.lenslet.propagateLenslets" title="Permalink to this definition">¶</a></dt>
<dd><p>Function propagateLenslets</p>
<p>This is the main propagation function. It puts the PSFLets where they belong on the detector.
It uses template PSFLets given in hires_arrs, and can use also a pre-determined wavelength
solution through the allcoef argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par: Params instance</strong></p>
<blockquote>
<div><p>Parameters instance for crispy</p>
</div></blockquote>
<p><strong>imageplane: 2D array</strong></p>
<blockquote>
<div><p>Flux map where each pixel corresponds to one lenslet</p>
</div></blockquote>
<p><strong>lam1: float</strong></p>
<blockquote>
<div><p>Minimum wavelength in IFS band</p>
</div></blockquote>
<p><strong>lam2: float</strong></p>
<blockquote>
<div><p>Maximum wavelength in IFS band</p>
</div></blockquote>
<p><strong>hires_arr: 4D ndarray</strong></p>
<blockquote>
<div><p>For each wavelength, for each location on the detector, a 2D array of the oversampled PSFLet</p>
</div></blockquote>
<p><strong>lam_arr: 1D array</strong></p>
<blockquote>
<div><p>Wavelength array corresponding to the hires_arr array</p>
</div></blockquote>
<p><strong>upsample: int</strong></p>
<blockquote>
<div><p>Factor by which the PSFLets are oversampled</p>
</div></blockquote>
<p><strong>nlam: int</strong></p>
<blockquote>
<div><p>Number of wavelengths to oversample a given wavelength bin</p>
</div></blockquote>
<p><strong>npix: int</strong></p>
<blockquote>
<div><p>PSFLet will be put on npix*npix detector pixels, models will be (npix*upsample)^2</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>Order used in the polynomial fit of the wavelength solution</p>
</div></blockquote>
<p><strong>x0: float</strong></p>
<blockquote class="last">
<div><p>Offset from the center of the detector in the vertical direction (x)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.locate_psflets">
<span id="tools-locate-psflets-module"></span><h2>tools.locate_psflets module<a class="headerlink" href="#module-tools.locate_psflets" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="tools.locate_psflets.PSFLets">
<em class="property">class </em><code class="descclassname">tools.locate_psflets.</code><code class="descname">PSFLets</code><span class="sig-paren">(</span><em>load=False</em>, <em>infile=None</em>, <em>infiledir='.'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper class to deal with the PSFLets on the detector. Does most of the heavy lifting
during the wavelength calibration step.</p>
<p>Initialize the class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>load: Boolean</strong></p>
<blockquote>
<div><p>Whether to load an already-existing wavelength calibration file</p>
</div></blockquote>
<p><strong>infile: String</strong></p>
<blockquote>
<div><p>If load is True, this is the name of the file</p>
</div></blockquote>
<p><strong>infiledir: String</strong></p>
<blockquote class="last">
<div><p>If load is True, this is the directory in which the file resides</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.locate_psflets.PSFLets.geninterparray">
<code class="descname">geninterparray</code><span class="sig-paren">(</span><em>lam</em>, <em>allcoef</em>, <em>order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets.geninterparray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets.geninterparray" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up array to solve for best-fit polynomial fits to the
coefficients of the wavelength solution.  These will be used
to smooth/interpolate the wavelength solution, and
ultimately to compute its inverse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lam: float</strong></p>
<blockquote>
<div><p>Wavelength in nm</p>
</div></blockquote>
<p><strong>allcoef: list of lists floats</strong></p>
<blockquote>
<div><p>Polynomial coefficients of wavelength solution</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote class="last">
<div><p>Order of polynomial wavelength solution</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Populates the attribute interp_arr in PSFLet class</p>
</dd></dl>

<dl class="method">
<dt id="tools.locate_psflets.PSFLets.genpixsol">
<code class="descname">genpixsol</code><span class="sig-paren">(</span><em>par</em>, <em>lam</em>, <em>allcoef</em>, <em>order=3</em>, <em>lam1=None</em>, <em>lam2=None</em>, <em>borderpix=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets.genpixsol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets.genpixsol" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the wavelength at the center of each pixel within a microspectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lam: float</strong></p>
<blockquote>
<div><p>Wavelength in nm</p>
</div></blockquote>
<p><strong>allcoef: list of floats</strong></p>
<blockquote>
<div><p>List describing the polynomial coefficients that best fit the lenslets,
for all wavelengths</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>Order of the polynomical fit</p>
</div></blockquote>
<p><strong>lam1: float</strong></p>
<blockquote>
<div><p>Lowest wavelength in nm</p>
</div></blockquote>
<p><strong>lam2: float</strong></p>
<blockquote class="last">
<div><p>Highest wavelength in nm</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This functions fills in most of the fields of the PSFLet class: the array
of xindx, yindx, nlam, lam_indx and nlam_max</p>
</dd></dl>

<dl class="method">
<dt id="tools.locate_psflets.PSFLets.loadpixsol">
<code class="descname">loadpixsol</code><span class="sig-paren">(</span><em>infile=None</em>, <em>infiledir='./calibrations'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets.loadpixsol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets.loadpixsol" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads existing wavelength calibration file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>infile: String</strong></p>
<blockquote>
<div><p>Name of the file</p>
</div></blockquote>
<p><strong>infiledir: String</strong></p>
<blockquote class="last">
<div><p>Directory in which the file resides</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.locate_psflets.PSFLets.monochrome_coef">
<code class="descname">monochrome_coef</code><span class="sig-paren">(</span><em>lam</em>, <em>alllam=None</em>, <em>allcoef=None</em>, <em>order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets.monochrome_coef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets.monochrome_coef" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.locate_psflets.PSFLets.return_locations">
<code class="descname">return_locations</code><span class="sig-paren">(</span><em>lam</em>, <em>allcoef</em>, <em>xindx</em>, <em>yindx</em>, <em>order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets.return_locations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets.return_locations" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the detector coordinates of lenslet located at <code class="xref py py-obj docutils literal"><span class="pre">xindx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">yindx</span></code>
for desired wavelength <code class="xref py py-obj docutils literal"><span class="pre">lam</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lam: float</strong></p>
<blockquote>
<div><p>Wavelength in nm</p>
</div></blockquote>
<p><strong>allcoef: list of lists floats</strong></p>
<blockquote>
<div><p>Polynomial coefficients of wavelength solution</p>
</div></blockquote>
<p><strong>xindx: int</strong></p>
<blockquote>
<div><p>X index of lenslet in lenslet array</p>
</div></blockquote>
<p><strong>yindx: int</strong></p>
<blockquote>
<div><p>Y index of lenslet in lenslet array</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>Order of polynomial wavelength solution</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">interp_x: float</p>
<blockquote>
<div><p>X coordinate on the detector</p>
</div></blockquote>
<p>interp_y: float</p>
<blockquote class="last">
<div><p>Y coordinate on the detector</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.locate_psflets.PSFLets.return_locations_short">
<code class="descname">return_locations_short</code><span class="sig-paren">(</span><em>coef</em>, <em>xindx</em>, <em>yindx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets.return_locations_short"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets.return_locations_short" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the x,y detector location of a given lenslet for a given polynomial fit</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>coef: lists floats</strong></p>
<blockquote>
<div><p>Polynomial coefficients of fit for a single wavelength</p>
</div></blockquote>
<p><strong>xindx: int</strong></p>
<blockquote>
<div><p>X index of lenslet in lenslet array</p>
</div></blockquote>
<p><strong>yindx: int</strong></p>
<blockquote>
<div><p>Y index of lenslet in lenslet array</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">interp_x: float</p>
<blockquote>
<div><p>X coordinate on the detector</p>
</div></blockquote>
<p>interp_y: float</p>
<blockquote class="last">
<div><p>Y coordinate on the detector</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.locate_psflets.PSFLets.return_res">
<code class="descname">return_res</code><span class="sig-paren">(</span><em>lam</em>, <em>allcoef</em>, <em>xindx</em>, <em>yindx</em>, <em>order=3</em>, <em>lam1=None</em>, <em>lam2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets.return_res"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets.return_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spectral resolution and interpolated wavelength array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lam: float</strong></p>
<blockquote>
<div><p>Wavelength in nm</p>
</div></blockquote>
<p><strong>allcoef: list of lists floats</strong></p>
<blockquote>
<div><p>Polynomial coefficients of wavelength solution</p>
</div></blockquote>
<p><strong>xindx: int</strong></p>
<blockquote>
<div><p>X index of lenslet in lenslet array</p>
</div></blockquote>
<p><strong>yindx: int</strong></p>
<blockquote>
<div><p>Y index of lenslet in lenslet array</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>Order of polynomial wavelength solution</p>
</div></blockquote>
<p><strong>lam1: float</strong></p>
<blockquote>
<div><p>Shortest wavelength in nm</p>
</div></blockquote>
<p><strong>lam2: float</strong></p>
<blockquote>
<div><p>Longest wavelength in nm</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">interp_lam: array</p>
<blockquote>
<div><p>Array of wavelengths</p>
</div></blockquote>
<p>R: float</p>
<blockquote class="last">
<div><p>Effective spectral resolution</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.locate_psflets.PSFLets.savepixsol">
<code class="descname">savepixsol</code><span class="sig-paren">(</span><em>outdir='calibrations/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#PSFLets.savepixsol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.PSFLets.savepixsol" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves wavelength calibration file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>outdir: String</strong></p>
<blockquote class="last">
<div><p>Directory in which to put the file. The file is name PSFloc.fits and is a
multi-extension FITS file, each extension corresponding to:
0. the list of wavelengths at which the calibration is done
1. a 2D ndarray with the X position of all lenslets
2. a 2D ndarray with the Y position of all lenslets
3. a 2D ndarray with the number of valid wavelengths for a given lenslet (some wavelengths fall outside of the detector area)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.locate_psflets.corrval">
<code class="descclassname">tools.locate_psflets.</code><code class="descname">corrval</code><span class="sig-paren">(</span><em>coef</em>, <em>x</em>, <em>y</em>, <em>filtered</em>, <em>order</em>, <em>trimfrac=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#corrval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.corrval" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the negative of the sum of the middle XX% of the PSFlet
spot fluxes (disregarding those with the most and the least flux
to limit the impact of outliers).  Analogous to the trimmed mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>coef:     list of floats</strong></p>
<blockquote>
<div><p>coefficients for polynomial transformation</p>
</div></blockquote>
<p><strong>x: ndarray</strong></p>
<blockquote>
<div><p>coordinates of lenslets</p>
</div></blockquote>
<p><strong>y: ndarray</strong></p>
<blockquote>
<div><p>coordinates of lenslets</p>
</div></blockquote>
<p><strong>filtered: ndarray</strong></p>
<blockquote>
<div><p>image convolved with gaussian PSFlet</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>order of the polynomial fit</p>
</div></blockquote>
<p><strong>trimfrac: float</strong></p>
<blockquote>
<div><p>fraction of outliers (high &amp; low combined) to trim
Default 0.1 (5% trimmed on the high end, 5% on the low end)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">score:    float</p>
<blockquote class="last">
<div><p>Negative sum of PSFlet fluxes, to be minimized</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.locate_psflets.initcoef">
<code class="descclassname">tools.locate_psflets.</code><code class="descname">initcoef</code><span class="sig-paren">(</span><em>order</em>, <em>scale=15.02</em>, <em>phi=2.0496941961364943</em>, <em>x0=0</em>, <em>y0=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#initcoef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.initcoef" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a set of coefficients including a rotation matrix plus zeros.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>order: int</strong></p>
<blockquote>
<div><p>The polynomial order of the grid distortion</p>
</div></blockquote>
<p><strong>scale: float</strong></p>
<blockquote>
<div><p>The linear separation in pixels of the PSFlets. Default 13.88.</p>
</div></blockquote>
<p><strong>phi:   float</strong></p>
<blockquote>
<div><p>The pitch angle of the lenslets.  Default atan(2)</p>
</div></blockquote>
<p><strong>x0:    float</strong></p>
<blockquote>
<div><p>x offset to apply to the central pixel. Default 0</p>
</div></blockquote>
<p><strong>y0:    float</strong></p>
<blockquote>
<div><p>y offset to apply to the central pixel. Default 0</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">coef: list of floats</p>
<blockquote class="last">
<div><p>A list of length (order+1)*(order+2) to be optimized.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The list of coefficients has space for a polynomial fit of the
input order (i.e., for order 3, up to terms like x**3 and x**2*y,
but not x**3*y).  It is all zeros in the output apart from the
rotation matrix given by scale and phi.</p>
</dd></dl>

<dl class="function">
<dt id="tools.locate_psflets.locatePSFlets">
<code class="descclassname">tools.locate_psflets.</code><code class="descname">locatePSFlets</code><span class="sig-paren">(</span><em>inImage</em>, <em>mask</em>, <em>polyorder=2</em>, <em>sig=0.7</em>, <em>coef=None</em>, <em>trimfrac=0.1</em>, <em>phi=2.0496941961364943</em>, <em>scale=15.02</em>, <em>nlens=108</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#locatePSFlets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.locatePSFlets" title="Permalink to this definition">¶</a></dt>
<dd><p>function locatePSFlets takes an Image class, assumed to be a
monochromatic grid of spots with read noise and shot noise, and
returns the esimated positions of the spot centroids.  This is
designed to constrain the domain of the PSF-let fitting later in
the pipeline.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>imImage: Image class</strong></p>
<blockquote>
<div><p>Assumed to be a monochromatic grid of spots</p>
</div></blockquote>
<p><strong>polyorder: float</strong></p>
<blockquote>
<div><p>order of the polynomial coordinate transformation. Default 2.</p>
</div></blockquote>
<p><strong>sig: float</strong></p>
<blockquote>
<div><p>standard deviation of convolving Gaussian used
for estimating the grid of centroids.  Should be close
to the true value for the PSF-let spots.  Default 0.7.</p>
</div></blockquote>
<p><strong>coef: list</strong></p>
<blockquote>
<div><p>initial guess of the coefficients of polynomial
coordinate transformation</p>
</div></blockquote>
<p><strong>trimfrac: float</strong></p>
<blockquote>
<div><p>fraction of lenslet outliers (high &amp; low
combined) to trim in the minimization.  Default 0.1
(5% trimmed on the high end, 5% on the low end)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">x: 2D ndarray</p>
<blockquote>
<div><p>Estimated spot centroids in x.</p>
</div></blockquote>
<p>y: 2D ndarray</p>
<blockquote>
<div><p>Estimated spot centroids in y.</p>
</div></blockquote>
<p>good:2D boolean ndarray</p>
<blockquote>
<div><p>True for lenslets with spots inside the detector footprint</p>
</div></blockquote>
<p>coef: list of floats</p>
<blockquote class="last">
<div><p>List of best-fit polynomial coefficients</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>the coefficients, if not supplied, are initially set to the
known pitch angle and scale.  A loop then does a quick check to find
reasonable offsets in x and y.  With all of the first-order polynomial
coefficients set, the optimizer refines these and the higher-order
coefficients.  This routine seems to be relatively robust down to
per-lenslet signal-to-noise ratios of order unity (or even a little
less).</p>
</dd></dl>

<dl class="function">
<dt id="tools.locate_psflets.transform">
<code class="descclassname">tools.locate_psflets.</code><code class="descname">transform</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>order</em>, <em>coef</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/locate_psflets.html#transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.locate_psflets.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the coefficients given to transform the coordinates using
a polynomial.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x:     ndarray</strong></p>
<blockquote>
<div><p>Rectilinear grid</p>
</div></blockquote>
<p><strong>y:     ndarray of floats</strong></p>
<blockquote>
<div><p>Rectilinear grid</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>Order of the polynomial fit</p>
</div></blockquote>
<p><strong>coef:  list of floats</strong></p>
<blockquote>
<div><p>List of the coefficients.  Must match the length required by
order = (order+1)*(order+2)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">_x:    ndarray</p>
<blockquote>
<div><p>Transformed coordinates</p>
</div></blockquote>
<p>_y:    ndarray</p>
<blockquote class="last">
<div><p>Transformed coordinates</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.par_utils">
<span id="tools-par-utils-module"></span><h2>tools.par_utils module<a class="headerlink" href="#module-tools.par_utils" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="tools.par_utils.Consumer">
<em class="property">class </em><code class="descclassname">tools.par_utils.</code><code class="descname">Consumer</code><span class="sig-paren">(</span><em>task_queue</em>, <em>result_queue</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/par_utils.html#Consumer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.par_utils.Consumer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">multiprocessing.process.Process</span></code></p>
<dl class="method">
<dt id="tools.par_utils.Consumer.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/par_utils.html#Consumer.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.par_utils.Consumer.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.par_utils.Task">
<em class="property">class </em><code class="descclassname">tools.par_utils.</code><code class="descname">Task</code><span class="sig-paren">(</span><em>index</em>, <em>func</em>, <em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/par_utils.html#Task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.par_utils.Task" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-tools.plotting">
<span id="tools-plotting-module"></span><h2>tools.plotting module<a class="headerlink" href="#module-tools.plotting" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.plotting.plotKernels">
<code class="descclassname">tools.plotting.</code><code class="descname">plotKernels</code><span class="sig-paren">(</span><em>par</em>, <em>kernels</em>, <em>locations</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/plotting.html#plotKernels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.plotting.plotKernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Make plots of all the kernels</p>
</dd></dl>

</div>
<div class="section" id="module-tools.postprocessing">
<span id="tools-postprocessing-module"></span><h2>tools.postprocessing module<a class="headerlink" href="#module-tools.postprocessing" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.postprocessing.RDI_noise">
<code class="descclassname">tools.postprocessing.</code><code class="descname">RDI_noise</code><span class="sig-paren">(</span><em>par</em>, <em>xshift</em>, <em>yshift</em>, <em>order=3</em>, <em>rootname='mflib'</em>, <em>outdir_time_series='OS5'</em>, <em>outdir_detector='OS5/OS5_detector'</em>, <em>outdir_average='OS5/OS5_average'</em>, <em>process_cubes=True</em>, <em>process_offaxis_files=True</em>, <em>process_detector=True</em>, <em>take_averages=True</em>, <em>countershift=True</em>, <em>normalize_cubes=True</em>, <em>forced_inttime_ref=50</em>, <em>offaxis_reduced='OS5/OS5_average/offaxis.fits'</em>, <em>psf_time_series_folder='/Users/mrizzo/IFS/OS5/with_lowfc'</em>, <em>Nref=30</em>, <em>ref_only=True</em>, <em>offaxis_psf_filename='/Users/mrizzo/IFS/OS5/offaxis/spc_offaxis_psf.fits'</em>, <em>ref_star_T=&lt;Quantity 9377.0 K&gt;</em>, <em>ref_star_Vmag=2.37</em>, <em>target_star_T=&lt;Quantity 5887.0 K&gt;</em>, <em>target_star_Vmag=5.03</em>, <em>IWA=3</em>, <em>OWA=9</em>, <em>lamc=660.0</em>, <em>BW=0.18</em>, <em>tel_pupil_area=&lt;Quantity 3.650265060424805 m2&gt;</em>, <em>mflib='/mflib.fits.gz'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#RDI_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.RDI_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the SNR map of a simulation using RDI.
Here we assume the target PSF time series is already in hand, and already in outdir_time_series.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par: Parameters instance</strong></p>
<blockquote>
<div><p>Crispy parameter instance</p>
</div></blockquote>
<p><strong>xshift: float</strong></p>
<blockquote>
<div><p>The amount to shift the input in X (in final IFS cube pixels)</p>
</div></blockquote>
<p><strong>yshift: float</strong></p>
<blockquote>
<div><p>The amount to shift the input in Y (in final IFS cube pixels)</p>
</div></blockquote>
<p><strong>order: integer</strong></p>
<blockquote>
<div><p>The order of the spline transform used for shifting the cubes</p>
</div></blockquote>
<p><strong>rootname: string</strong></p>
<blockquote>
<div><p>The root name of the final SNR cube maps</p>
</div></blockquote>
<p><strong>outdir_time_series: string</strong></p>
<blockquote>
<div><p>Path to which we will export the IFS fluxes at the detector</p>
</div></blockquote>
<p><strong>outdir_detector: string</strong></p>
<blockquote>
<div><p>Path to the folder where we will put the detector maps</p>
</div></blockquote>
<p><strong>outdir_average: string</strong></p>
<blockquote>
<div><p>Path to the folder where we will put the final results and other byproducts of the function</p>
</div></blockquote>
<p><strong>process_cubes: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to process the IFS cubes, or assume that they are already processed</p>
</div></blockquote>
<p><strong>countershift: Boolean</strong></p>
<blockquote>
<div><p>Whether to countershift the reference star or not</p>
</div></blockquote>
<p><strong>normalize_contrast: Boolean</strong></p>
<blockquote>
<div><p>Whether to normalize the SNR map to contrast units using off-axis PSF</p>
</div></blockquote>
<p><strong>offaxis_reduced: string</strong></p>
<blockquote>
<div><p>Path to the offaxis PSF that will be used for contrast normalization</p>
</div></blockquote>
<p><strong>psf_time_series_folder: string</strong></p>
<blockquote>
<div><p>Path to the folder where all the original files are located</p>
</div></blockquote>
<p><strong>Nref: integer</strong></p>
<blockquote>
<div><p>Out of the files in John Krist’s folder, how many correspond to observations of the reference star</p>
</div></blockquote>
<p><strong>ref_only: Boolean</strong></p>
<blockquote>
<div><p>Whether to only process the reference files or also target files</p>
</div></blockquote>
<p><strong>ref_star_T: ‘u.K’</strong></p>
<blockquote>
<div><p>Temperature of the reference star in u.K</p>
</div></blockquote>
<p><strong>target_star_T: ‘u.K’</strong></p>
<blockquote>
<div><p>Temperature of the target star in u.K</p>
</div></blockquote>
<p><strong>ref_star_Vmag: float</strong></p>
<blockquote>
<div><p>V Magnitude of the reference star</p>
</div></blockquote>
<p><strong>target_star_Vmag: float</strong></p>
<blockquote>
<div><p>V Magnitude of the target star</p>
</div></blockquote>
<p><strong>lamc: float</strong></p>
<blockquote>
<div><p>Central wavelength of the band, in nm</p>
</div></blockquote>
<p><strong>BW: float</strong></p>
<blockquote>
<div><p>Bandwidth</p>
</div></blockquote>
<p><strong>tel_pupil_area: ‘u.m**2’</strong></p>
<blockquote>
<div><p>Collecting area of the telescope, minus obscurations, in u.m**2</p>
</div></blockquote>
<p><strong>mflib: string</strong></p>
<blockquote>
<div><p>Name of the matched filter library file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">pixstd: array</p>
<blockquote class="last">
<div><p>List of slice-by-slice standard deviation of the RDI cube convolved with the matched filter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.SNR_spectrum">
<code class="descclassname">tools.postprocessing.</code><code class="descname">SNR_spectrum</code><span class="sig-paren">(</span><em>lam_midpts</em>, <em>signal</em>, <em>noise</em>, <em>filename='Jupiter_1x_5AU_90deg.dat'</em>, <em>planet_radius=1.27</em>, <em>planet_AU=3.6</em>, <em>albedo=0.28</em>, <em>lam_contrast=None</em>, <em>plot=True</em>, <em>outname='SNR.png'</em>, <em>outfolder=''</em>, <em>title='Planet+star'</em>, <em>edges=1</em>, <em>FWHM=2</em>, <em>FWHMdata=2.0</em>, <em>ymargin=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#SNR_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.SNR_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the outputs of process_SPC_IFS</p>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.construct_mflib">
<code class="descclassname">tools.postprocessing.</code><code class="descname">construct_mflib</code><span class="sig-paren">(</span><em>par</em>, <em>planet_cube</em>, <em>threshold</em>, <em>lamc</em>, <em>BW</em>, <em>outdir</em>, <em>mask</em>, <em>trim=30</em>, <em>outname='mflib.fits.gz'</em>, <em>order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#construct_mflib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.construct_mflib" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a library of matched filters for all points within the bowtie mask
For now, this uses the reduced, ideal offaxis psf already in cube space.
We could also build a function that offsets the original file, before IFS transformation.</p>
<p>This particular function saves memory and time by only recording the relevant pixels</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par: Parameters instance</strong></p>
<blockquote>
<div><p>Crispy parameter instance</p>
</div></blockquote>
<p><strong>planet_cube: string</strong></p>
<blockquote>
<div><p>Path to the off-axis planet IFS cube</p>
</div></blockquote>
<p><strong>threshold: float</strong></p>
<blockquote>
<div><p>Value below which we zero out the matched filter pixels</p>
</div></blockquote>
<p><strong>lamc: float</strong></p>
<blockquote>
<div><p>Central wavelength in nm</p>
</div></blockquote>
<p><strong>BW: float</strong></p>
<blockquote>
<div><p>Spectral bandwidth</p>
</div></blockquote>
<p><strong>outdir: string</strong></p>
<blockquote>
<div><p>Export directory</p>
</div></blockquote>
<p><strong>mask: 2D ndarray</strong></p>
<blockquote>
<div><p>2D bowtie mask. If left to None, then the bowtie mask is calculated and IWA and OWA need to be specified</p>
</div></blockquote>
<p><strong>IWA: float</strong></p>
<blockquote>
<div><p>Inner working angle (in terms of lam/D</p>
</div></blockquote>
<p><strong>OWA: float</strong></p>
<blockquote>
<div><p>Outer working angle (in terms of lam/D</p>
</div></blockquote>
<p><strong>trim: integer</strong></p>
<blockquote>
<div><p>How much to trim the cubes on each side to save memory space (nominally 30)</p>
</div></blockquote>
<p><strong>outname: string</strong></p>
<blockquote>
<div><p>Name of the matched filter library file. Highly recommend to compress it to save space</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote class="last">
<div><p>Order at which we do the spline transformation to move offaxis PSF around.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.convolved_mf">
<code class="descclassname">tools.postprocessing.</code><code class="descname">convolved_mf</code><span class="sig-paren">(</span><em>incube</em>, <em>mflibname</em>, <em>trim=30</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#convolved_mf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.convolved_mf" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a pseudo-convolution of the image by the matched filter library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>incube: 3D ndarray</strong></p>
<blockquote>
<div><p>Cube to convolve. Make sure all NaNs have been converted to zeros</p>
</div></blockquote>
<p><strong>mflibname: string</strong></p>
<blockquote>
<div><p>Path to the Matched Filter library, that was pre-computed</p>
</div></blockquote>
<p><strong>trim: integer</strong></p>
<blockquote>
<div><p>How much to trim the cubes on each side to save memory space (nominally 30)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">convolvedmap: 3D ndarray</p>
<blockquote class="last">
<div><p>Input cube multiplied in each non-zero pixel by the matched filter corresponding to that pixel</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.mf">
<code class="descclassname">tools.postprocessing.</code><code class="descname">mf</code><span class="sig-paren">(</span><em>cube</em>, <em>mask</em>, <em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#mf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.mf" title="Permalink to this definition">¶</a></dt>
<dd><p>Matched filter function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cube: 3D ndarray</strong></p>
<blockquote>
<div><p>An IFS cube representing the offaxis PSF, from which to compute the matched filter</p>
</div></blockquote>
<p><strong>mask: 2D ndarray</strong></p>
<blockquote>
<div><p>This is typically the coronagraphic mask</p>
</div></blockquote>
<p><strong>threshold: float</strong></p>
<blockquote>
<div><p>Fraction of max below which we crop the normalized PSF</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">matched_filter: 3D ndarray</p>
<blockquote class="last">
<div><p>Matched filter with the same dimensions as input cube</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.processReferenceCubes">
<code class="descclassname">tools.postprocessing.</code><code class="descname">processReferenceCubes</code><span class="sig-paren">(</span><em>par</em>, <em>xshift=0.0</em>, <em>yshift=0.0</em>, <em>order=3</em>, <em>outdir_time_series='OS5'</em>, <em>ref_input_list=[]</em>, <em>process_cubes=True</em>, <em>ref_star_T=&lt;Quantity 9377.0 K&gt;</em>, <em>ref_star_Vmag=2.37</em>, <em>lamc=660.0</em>, <em>BW=0.18</em>, <em>tel_pupil_area=&lt;Quantity 3.650265060424805 m2&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#processReferenceCubes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.processReferenceCubes" title="Permalink to this definition">¶</a></dt>
<dd><p>Processes raw cubes from John Krist into IFS flux cubes just before the IFS.
Doesn’t take into account the optical losses, but does take into account the detector QE.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par: Parameters instance</strong></p>
<blockquote>
<div><p>Crispy parameter instance</p>
</div></blockquote>
<p><strong>xshift: float</strong></p>
<blockquote>
<div><p>The amount to shift the input in X (in final IFS cube pixels)</p>
</div></blockquote>
<p><strong>yshift: float</strong></p>
<blockquote>
<div><p>The amount to shift the input in Y (in final IFS cube pixels)</p>
</div></blockquote>
<p><strong>order: integer</strong></p>
<blockquote>
<div><p>The order of the spline transform used for shifting the cubes</p>
</div></blockquote>
<p><strong>outdir_time_series: string</strong></p>
<blockquote>
<div><p>Path to which we will export the IFS fluxes at the detector</p>
</div></blockquote>
<p><strong>ref_input_list: string</strong></p>
<blockquote>
<div><p>List of filenames with the reference cubes</p>
</div></blockquote>
<p><strong>Nref: integer</strong></p>
<blockquote>
<div><p>Out of the files in John Krist’s folder, how many correspond to observations of the reference star</p>
</div></blockquote>
<p><strong>ref_only: Boolean</strong></p>
<blockquote>
<div><p>Whether to only process the reference files or also target files</p>
</div></blockquote>
<p><strong>ref_star_T: ‘u.K’</strong></p>
<blockquote>
<div><p>Temperature of the reference star in u.K</p>
</div></blockquote>
<p><strong>ref_star_Vmag: float</strong></p>
<blockquote>
<div><p>V Magnitude of the reference star</p>
</div></blockquote>
<p><strong>lamc: float</strong></p>
<blockquote>
<div><p>Central wavelength of the band, in nm</p>
</div></blockquote>
<p><strong>BW: float</strong></p>
<blockquote>
<div><p>Bandwidth</p>
</div></blockquote>
<p><strong>tel_pupil_area: ‘u.m**2’</strong></p>
<blockquote>
<div><p>Collecting area of the telescope, minus obscurations, in u.m**2</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ref_outlist: list of strings</p>
<blockquote>
<div><p>List of the filenames corresponding the reference star</p>
</div></blockquote>
<p>target_outlist: list of strings</p>
<blockquote>
<div><p>List of the filenames corresponding the target star</p>
</div></blockquote>
<p>fileshape: tuple</p>
<blockquote class="last">
<div><p>Size of the original John Krist cube</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.processTargetCubes">
<code class="descclassname">tools.postprocessing.</code><code class="descname">processTargetCubes</code><span class="sig-paren">(</span><em>par</em>, <em>target_file_list</em>, <em>outdir_time_series='OS5'</em>, <em>process_cubes=True</em>, <em>target_star_T=&lt;Quantity 5887.0 K&gt;</em>, <em>target_star_Vmag=5.03</em>, <em>lamc=660.0</em>, <em>BW=0.18</em>, <em>tel_pupil_area=&lt;Quantity 3.650265060424805 m2&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#processTargetCubes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.processTargetCubes" title="Permalink to this definition">¶</a></dt>
<dd><p>Processes raw cubes from John Krist into IFS flux cubes just before the IFS.
Doesn’t take into account the optical losses, but does take into account the detector QE.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par: Parameters instance</strong></p>
<blockquote>
<div><p>Crispy parameter instance</p>
</div></blockquote>
<p><strong>target_file_list: string</strong></p>
<blockquote>
<div><p>List of files</p>
</div></blockquote>
<p><strong>outdir_time_series: string</strong></p>
<blockquote>
<div><p>Path to which we will export the IFS fluxes at the detector</p>
</div></blockquote>
<p><strong>target_star_T: ‘u.K’</strong></p>
<blockquote>
<div><p>Temperature of the target star in u.K</p>
</div></blockquote>
<p><strong>target_star_Vmag: float</strong></p>
<blockquote>
<div><p>V Magnitude of the target star</p>
</div></blockquote>
<p><strong>lamc: float</strong></p>
<blockquote>
<div><p>Central wavelength of the band, in nm</p>
</div></blockquote>
<p><strong>BW: float</strong></p>
<blockquote>
<div><p>Bandwidth</p>
</div></blockquote>
<p><strong>tel_pupil_area: ‘u.m**2’</strong></p>
<blockquote>
<div><p>Collecting area of the telescope, minus obscurations, in u.m**2</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">target_outlist: list of strings</p>
<blockquote class="last">
<div><p>List of the filenames corresponding the target star</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.process_SPC_IFS">
<code class="descclassname">tools.postprocessing.</code><code class="descname">process_SPC_IFS</code><span class="sig-paren">(</span><em>par</em>, <em>psf_time_series_folder</em>, <em>offaxis_psf_filename</em>, <em>planet_radius=&lt;Quantity 90794840.0 m&gt;</em>, <em>planet_AU=3.6</em>, <em>planet_dist_pc=14.1</em>, <em>ref_star_T=&lt;Quantity 9377.0 K&gt;</em>, <em>ref_star_Vmag=2.37</em>, <em>target_star_T=&lt;Quantity 5887.0 K&gt;</em>, <em>target_star_Vmag=5.03</em>, <em>lamc=770.0</em>, <em>BW=0.18</em>, <em>n_ref_star_imgs=30</em>, <em>tel_pupil_area=&lt;Quantity 3.650265060424805 m2&gt;</em>, <em>IWA=3</em>, <em>OWA=9</em>, <em>xshift=0.0</em>, <em>yshift=0.0</em>, <em>pp_fact=0.05</em>, <em>t_zodi=0.09</em>, <em>useQE=True</em>, <em>subtract_ref_psf=True</em>, <em>outdir_time_series='OS5'</em>, <em>outdir_detector='OS5/OS5_detector'</em>, <em>outdir_average='OS5/OS5_average'</em>, <em>process_cubes=True</em>, <em>process_offaxis=True</em>, <em>process_detector=True</em>, <em>process_noiseless=False</em>, <em>take_averages=True</em>, <em>parallel=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#process_SPC_IFS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.process_SPC_IFS" title="Permalink to this definition">¶</a></dt>
<dd><p>Process SPC PSF cubes from J. Krist through the IFS</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par: Params instance</strong></p>
<blockquote>
<div><p>Contains all the parameters of the IFS</p>
</div></blockquote>
<p><strong>psf_time_series_folder: string</strong></p>
<blockquote>
<div><p>Where the files from Krist are located</p>
</div></blockquote>
<p><strong>offaxis_psf_filename: string</strong></p>
<blockquote>
<div><p>Where the off-axis PSF is located</p>
</div></blockquote>
<p><strong>mean_contrast: float</strong></p>
<blockquote>
<div><p>Mean contrast of the planet spectrum</p>
</div></blockquote>
<p><strong>ref_star_T: `u.K` float</strong></p>
<blockquote>
<div><p>Reference star temperature, float multiplied by astropy.units.K</p>
</div></blockquote>
<p><strong>ref_star_Vmag: float</strong></p>
<blockquote>
<div><p>Vmag of the reference star</p>
</div></blockquote>
<p><strong>target_star_T: `u.K` float</strong></p>
<blockquote>
<div><p>Target star temperature, float multiplied by astropy.units.K</p>
</div></blockquote>
<p><strong>target_star_T_star_Vmag: float</strong></p>
<blockquote>
<div><p>Vmag of the target star</p>
</div></blockquote>
<p><strong>lamc: float</strong></p>
<blockquote>
<div><p>Band’s central wavelength in nm</p>
</div></blockquote>
<p><strong>BW: float</strong></p>
<blockquote>
<div><p>Bandwidth</p>
</div></blockquote>
<p><strong>n_ref_star_imgs: int</strong></p>
<blockquote>
<div><p>Number of reference star images in the list</p>
</div></blockquote>
<p><strong>tel_pupil_area: `u.m**2` float</strong></p>
<blockquote>
<div><p>Effective surface area of telescope, including all geometric losses. Float
multiplied by astropy.units.m**2</p>
</div></blockquote>
<p><strong>IWA: float</strong></p>
<blockquote>
<div><p>Inner working angle defined at par.lenslet_wav</p>
</div></blockquote>
<p><strong>OWA: float</strong></p>
<blockquote>
<div><p>Outer working angle defined at par.lenslet_wav</p>
</div></blockquote>
<p><strong>pp_fact: float</strong></p>
<blockquote>
<div><p>Post-processing factor - multiplies the target star PSF</p>
</div></blockquote>
<p><strong>t_zodi = float</strong></p>
<blockquote>
<div><p>Zodi transmission</p>
</div></blockquote>
<p><strong>outdir_time_series: string</strong></p>
<blockquote>
<div><p>Where to store the noiseless IFS detector images</p>
</div></blockquote>
<p><strong>outdir_detector: string</strong></p>
<blockquote>
<div><p>Where to store the noisy IFS detector images</p>
</div></blockquote>
<p><strong>outdir_average: string</strong></p>
<blockquote>
<div><p>Where to store the averages of the time series</p>
</div></blockquote>
<p><strong>process_cubes: Boolean</strong></p>
<blockquote>
<div><p>Whether to process the raw images from Krist, or skip this step if it was already done</p>
</div></blockquote>
<p><strong>process_offaxis: Boolean</strong></p>
<blockquote>
<div><p>Whether to process the offaxis images and add it to the images</p>
</div></blockquote>
<p><strong>process_detector: Boolean</strong></p>
<blockquote>
<div><p>Whether to add detector QE, IFS losses and noise to the IFS images</p>
</div></blockquote>
<p><strong>process_noiseless: Boolean</strong></p>
<blockquote>
<div><p>Whether to add detector QE, IFS losses but no detector noise to the IFS images</p>
</div></blockquote>
<p><strong>take_averages: Boolean</strong></p>
<blockquote>
<div><p>Whether to average all IFS detector images in the time series to create averages</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">signal: ndarray</p>
<blockquote>
<div><p>Array with the matched-filtered flux at each of the final cube’s wavelengths;
The background is already subtracted</p>
</div></blockquote>
<p>noise: ndarray</p>
<blockquote class="last">
<div><p>Noise estimate using the pixel-to-pixel variance within the dark hole, multiplied
by the number of effective pixels within the matched filter (sum of matched filter
cube)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.process_SPC_IFS2">
<code class="descclassname">tools.postprocessing.</code><code class="descname">process_SPC_IFS2</code><span class="sig-paren">(</span><em>par</em>, <em>psf_time_series_folder</em>, <em>offaxis_psf_filename</em>, <em>xshift=0.0</em>, <em>yshift=0.0</em>, <em>order=3</em>, <em>albedo_filename='Jupiter_1x_5AU_90deg.dat'</em>, <em>planet_radius=1.27</em>, <em>planet_AU=3.6</em>, <em>planet_dist_pc=14.1</em>, <em>albedo=0.28</em>, <em>ref_star_T=&lt;Quantity 9377.0 K&gt;</em>, <em>ref_star_Vmag=2.37</em>, <em>target_star_T=&lt;Quantity 5887.0 K&gt;</em>, <em>target_star_Vmag=5.03</em>, <em>lamc=770.0</em>, <em>BW=0.18</em>, <em>n_ref_star_imgs=30</em>, <em>tel_pupil_area=&lt;Quantity 3.650265060424805 m2&gt;</em>, <em>IWA=3</em>, <em>OWA=9</em>, <em>forced_inttime_ref=10.0</em>, <em>forced_tottime_ref=1000.0</em>, <em>pp_fact=1.0</em>, <em>RDI=True</em>, <em>subtract_dark=False</em>, <em>normalize_cubes=True</em>, <em>t_zodi=0.09</em>, <em>useQE=True</em>, <em>mflib='/mflib.fits.gz'</em>, <em>outdir_time_series='OS5'</em>, <em>outdir_detector='OS5/OS5_detector'</em>, <em>outdir_average='OS5/OS5_average'</em>, <em>process_cubes=True</em>, <em>process_offaxis_files=True</em>, <em>process_detector=True</em>, <em>take_averages=True</em>, <em>take_ref_average=True</em>, <em>nosource=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#process_SPC_IFS2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.process_SPC_IFS2" title="Permalink to this definition">¶</a></dt>
<dd><p>Process SPC PSF cubes from J. Krist through the IFS</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par: Params instance</strong></p>
<blockquote>
<div><p>Contains all the parameters of the IFS</p>
</div></blockquote>
<p><strong>psf_time_series_folder: string</strong></p>
<blockquote>
<div><p>Where the files from Krist are located</p>
</div></blockquote>
<p><strong>offaxis_psf_filename: string</strong></p>
<blockquote>
<div><p>Where the off-axis PSF is located</p>
</div></blockquote>
<p><strong>xshift: float</strong></p>
<blockquote>
<div><p>X-shift of the reference star with respect to the target star(pixels)</p>
</div></blockquote>
<p><strong>yshift: float</strong></p>
<blockquote>
<div><p>Y-shift of the reference star with respect to the target star(pixels)</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>Order of all interpolations (3 recommended)</p>
</div></blockquote>
<p><strong>albedo_filename: string</strong></p>
<blockquote>
<div><p>Name of file containing the geometric albedo of the planet, located in Inputs/ folder</p>
</div></blockquote>
<p><strong>planet_radius: float</strong></p>
<blockquote>
<div><p>Radius of planet in Jupiter radii</p>
</div></blockquote>
<p><strong>planet_AU: float</strong></p>
<blockquote>
<div><p>Distance of the planet from its star in AU</p>
</div></blockquote>
<p><strong>planet_dist_pc: float</strong></p>
<blockquote>
<div><p>Distance of the star system in pc</p>
</div></blockquote>
<p><strong>albedo: float</strong></p>
<blockquote>
<div><p>Overrides the albedo. If None, then the original albedo curve is used. If not None,
then the maximum of the albedo curve is normalized to the new albedo, while keeping
overall albedo shape</p>
</div></blockquote>
<p><strong>ref_star_T: `u.K` float</strong></p>
<blockquote>
<div><p>Reference star temperature, float multiplied by astropy.units.K</p>
</div></blockquote>
<p><strong>ref_star_Vmag: float</strong></p>
<blockquote>
<div><p>Vmag of the reference star</p>
</div></blockquote>
<p><strong>target_star_T: `u.K` float</strong></p>
<blockquote>
<div><p>Target star temperature, float multiplied by astropy.units.K</p>
</div></blockquote>
<p><strong>target_star_T_star_Vmag: float</strong></p>
<blockquote>
<div><p>Vmag of the target star</p>
</div></blockquote>
<p><strong>lamc: float</strong></p>
<blockquote>
<div><p>Band’s central wavelength in nm</p>
</div></blockquote>
<p><strong>BW: float</strong></p>
<blockquote>
<div><p>Bandwidth</p>
</div></blockquote>
<p><strong>n_ref_star_imgs: int</strong></p>
<blockquote>
<div><p>Number of reference star images in the list</p>
</div></blockquote>
<p><strong>tel_pupil_area: `u.m**2` float</strong></p>
<blockquote>
<div><p>Effective surface area of telescope, including all geometric losses. Float
multiplied by astropy.units.m**2</p>
</div></blockquote>
<p><strong>IWA: float</strong></p>
<blockquote>
<div><p>Inner working angle defined at par.lenslet_wav</p>
</div></blockquote>
<p><strong>OWA: float</strong></p>
<blockquote>
<div><p>Outer working angle defined at par.lenslet_wav</p>
</div></blockquote>
<p><strong>forced_inttime_ref: float</strong></p>
<blockquote>
<div><p>Forced time of a single integration for the reference star. This should be smaller
than the individual integration time for the target since the reference star
is typically brighter</p>
</div></blockquote>
<p><strong>forced_tottime_ref: float</strong></p>
<blockquote>
<div><p>Forced time spent for a single input cube for the reference. Typically, this is the
same as the time for a single input cube for the target</p>
</div></blockquote>
<p><strong>pp_fact: float</strong></p>
<blockquote>
<div><p>Post-processing factor - artificially multiplies the target star PSF. Note that
this is NOT the same as Bijan’s f_pp</p>
</div></blockquote>
<p><strong>RDI: Boolean</strong></p>
<blockquote>
<div><p>If True, run an RDI function to clean up the raw cubes.</p>
</div></blockquote>
<p><strong>mflib: String</strong></p>
<blockquote>
<div><p>Path towards an already-existing matched filter library. If empty string is given,
the software will construct the library each time</p>
</div></blockquote>
<p><strong>subtract_dark: Boolean</strong></p>
<blockquote>
<div><p>If True, estimate the mean dark region (bottom of the detector) and subtract from
map. Default: True. For different kinds of input maps that might cover the entire
defector, this might be more tricky.</p>
</div></blockquote>
<p><strong>normalize_cubes: Boolean</strong></p>
<blockquote>
<div><p>If True, all cubes are normalized to contrast units. Default is True.</p>
</div></blockquote>
<p><strong>t_zodi: float</strong></p>
<blockquote>
<div><p>Zodi transmission (not operational for now)</p>
</div></blockquote>
<p><strong>useQE: Boolean</strong></p>
<blockquote>
<div><p>If True, the QE is applied when constructing the IFS maps. Note that in this case
the QE file should represent both the actual detector QE, and the wavelength-dependent
optical losses</p>
</div></blockquote>
<p><strong>outdir_time_series: string</strong></p>
<blockquote>
<div><p>Where to store the noiseless IFS detector images</p>
</div></blockquote>
<p><strong>outdir_detector: string</strong></p>
<blockquote>
<div><p>Where to store the noisy IFS detector images</p>
</div></blockquote>
<p><strong>outdir_average: string</strong></p>
<blockquote>
<div><p>Where to store the averages of the time series</p>
</div></blockquote>
<p><strong>process_cubes: Boolean</strong></p>
<blockquote>
<div><p>Whether to process the raw images from Krist, or skip this step if it was already done</p>
</div></blockquote>
<p><strong>process_offaxis: Boolean</strong></p>
<blockquote>
<div><p>Whether to process the offaxis images and add it to the images</p>
</div></blockquote>
<p><strong>process_detector: Boolean</strong></p>
<blockquote>
<div><p>Whether to add detector QE, IFS losses and noise to the IFS images</p>
</div></blockquote>
<p><strong>process_noiseless: Boolean</strong></p>
<blockquote>
<div><p>Whether to add detector QE, IFS losses but no detector noise to the IFS images</p>
</div></blockquote>
<p><strong>take_averages: Boolean</strong></p>
<blockquote>
<div><p>Whether to average all IFS detector images in the time series to create averages</p>
</div></blockquote>
<p><strong>nosource: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to process everything without actually adding the planet</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">signal: ndarray</p>
<blockquote>
<div><p>Array with the matched-filtered flux at each of the final cube’s wavelengths;
The background is already subtracted</p>
</div></blockquote>
<p>noise: ndarray</p>
<blockquote class="last">
<div><p>Noise estimate using the pixel-to-pixel variance within the dark hole, multiplied
by the number of effective pixels within the matched filter (sum of matched filter
cube)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.process_offaxis">
<code class="descclassname">tools.postprocessing.</code><code class="descname">process_offaxis</code><span class="sig-paren">(</span><em>par</em>, <em>offaxis_psf_filename</em>, <em>fileshape</em>, <em>lamlist</em>, <em>lamc</em>, <em>outdir_average</em>, <em>Nave=1</em>, <em>inttime=1</em>, <em>Nreads=1</em>, <em>filename='Jupiter_1x_5AU_90deg.dat'</em>, <em>planet_radius=1.27</em>, <em>planet_AU=3.6</em>, <em>planet_dist_pc=14.1</em>, <em>albedo=0.28</em>, <em>target_star_T=&lt;Quantity 5887.0 K&gt;</em>, <em>target_star_Vmag=5.03</em>, <em>ref_star_T=&lt;Quantity 9377.0 K&gt;</em>, <em>ref_star_Vmag=2.37</em>, <em>tel_pupil_area=&lt;Quantity 3.650265060424805 m2&gt;</em>, <em>order=3</em>, <em>useQE=True</em>, <em>polychromeOut=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#process_offaxis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.process_offaxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Processes an off-axis PSF cube from John Krist. This is used to to construct an ideal cube of the planet</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par: Parameters instance</strong></p>
<blockquote>
<div><p>Crispy parameter instance</p>
</div></blockquote>
<p><strong>offaxis_psf_filename: string</strong></p>
<blockquote>
<div><p>Path to the off-axis cube from J. Krist</p>
</div></blockquote>
<p><strong>fileshape: tuple</strong></p>
<blockquote>
<div><p>Size of the original John Krist cube</p>
</div></blockquote>
<p><strong>lamlist: list</strong></p>
<blockquote>
<div><p>List of wavelengths corresponding to each slice</p>
</div></blockquote>
<p><strong>lamc: float</strong></p>
<blockquote>
<div><p>Central wavelength</p>
</div></blockquote>
<p><strong>outdir_average: string</strong></p>
<blockquote>
<div><p>Path to which we will export the off-axis IFS flux maps at the detector</p>
</div></blockquote>
<p><strong>Nave: integer</strong></p>
<blockquote>
<div><p>Number of files to average. This needs to be the same number as the number of times the target is averaged (nominally 100)</p>
</div></blockquote>
<p><strong>target_star_T: ‘u.K’</strong></p>
<blockquote>
<div><p>Temperature of the target star in u.K</p>
</div></blockquote>
<p><strong>target_star_Vmag: float</strong></p>
<blockquote>
<div><p>V Magnitude of the target star</p>
</div></blockquote>
<p><strong>tel_pupil_area: ‘u.m**2’</strong></p>
<blockquote>
<div><p>Collecting area of the telescope, minus obscurations, in u.m**2</p>
</div></blockquote>
<p><strong>polychromeOut: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to export a polychrome cube weighted by the PSF</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">offaxis_reduced: 3D ndarray</p>
<blockquote class="last">
<div><p>Reduced cube</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.postprocessing.recenter_offaxis">
<code class="descclassname">tools.postprocessing.</code><code class="descname">recenter_offaxis</code><span class="sig-paren">(</span><em>offaxis_file</em>, <em>threshold</em>, <em>outname='centered_offaxis.fits'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/postprocessing.html#recenter_offaxis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.postprocessing.recenter_offaxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Example: recenter_offaxis(‘/Users/mrizzo/IFS/OS5/offaxis/spc_offaxis_psf.fits’,0.01,par.exportDir+’/centered_offaxis.fits’)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>offaxis_file: string</strong></p>
<blockquote>
<div><p>Path to off-axis file from John Krist</p>
</div></blockquote>
<p><strong>threshold: float</strong></p>
<blockquote>
<div><p>Threshold under which we don’t care about the values</p>
</div></blockquote>
<p><strong>outname: string</strong></p>
<blockquote>
<div><p>The path to the centered off axis cube</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">outkey: HDUList</p>
<blockquote class="last">
<div><p>HDU list of the recentered cube</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.reduction">
<span id="tools-reduction-module"></span><h2>tools.reduction module<a class="headerlink" href="#module-tools.reduction" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.reduction.RL">
<code class="descclassname">tools.reduction.</code><code class="descname">RL</code><span class="sig-paren">(</span><em>img</em>, <em>psflets</em>, <em>niter=10</em>, <em>guess=None</em>, <em>eps=1e-10</em>, <em>prior=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#RL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.RL" title="Permalink to this definition">¶</a></dt>
<dd><p>Richardson-Lucy deconvolution</p>
</dd></dl>

<dl class="function">
<dt id="tools.reduction.calculateWaveList">
<code class="descclassname">tools.reduction.</code><code class="descname">calculateWaveList</code><span class="sig-paren">(</span><em>par</em>, <em>lam_list=None</em>, <em>Nspec=None</em>, <em>method='lstsq'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#calculateWaveList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.calculateWaveList" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the wavelength lists corresponding to the center and endpoints of each
spectral bin. Wavelengths are separated by a constant value in log space. Number of
wavelengths depends on spectral resolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par:    Parameter instance</strong></p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>lam_list:   list of floats</strong></p>
<blockquote>
<div><p>Usually this is left to None. If so, we use the wavelengths used for wavelength
calibration. Otherwise, we could decide to focus on a smaller/larger region of
the spectrum to retrieve. The final processed cubes will have bins centered
on lam_midpts</p>
</div></blockquote>
<p><strong>Nspec: int</strong></p>
<blockquote>
<div><p>If specified, forces the number of bins in the final cube (uses np.linspace)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lam_midpts: list of floats</p>
<blockquote>
<div><p>Wavelengths at the midpoint of each bin</p>
</div></blockquote>
<p>lam_endpts: list of floats</p>
<blockquote class="last">
<div><p>Wavelengths at the edges of each bin</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.reduction.fit_cutout">
<code class="descclassname">tools.reduction.</code><code class="descname">fit_cutout</code><span class="sig-paren">(</span><em>subim</em>, <em>psflets</em>, <em>mode='lstsq'</em>, <em>niter=5</em>, <em>pixnoise=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#fit_cutout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.fit_cutout" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a series of PSFlets to an image, recover the best-fit coefficients.
This is currently little more than a wrapper for np.linalg.lstsq, but
could be more complex if/when we regularize the problem or adopt some
other approach.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>subim:   2D nadarray</strong></p>
<blockquote>
<div><p>Microspectrum to fit</p>
</div></blockquote>
<p><strong>psflets: 3D ndarray</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>First dimension is wavelength.  psflets[0]</dt>
<dd><p class="first last">must match the shape of subim.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>mode:    string</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>Method to use.  Currently limited to lstsq (a</dt>
<dd><p class="first last">simple least-squares fit using linalg.lstsq), this can
be expanded to include an arbitrary approach.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">coef:    array</p>
<blockquote class="last">
<div><p>The best-fit coefficients (i.e. the microspectrum).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This routine may also return the covariance matrix in the future.
It will depend on the performance of the algorithms and whether/how we
implement regularization.</p>
</dd></dl>

<dl class="function">
<dt id="tools.reduction.fitspec_intpix">
<code class="descclassname">tools.reduction.</code><code class="descname">fitspec_intpix</code><span class="sig-paren">(</span><em>par</em>, <em>im</em>, <em>PSFlet_tool</em>, <em>lamlist</em>, <em>delt_y=6</em>, <em>flat=None</em>, <em>mode='gaussvar'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#fitspec_intpix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.fitspec_intpix" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal extraction routine</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameter instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>im:     Image instance</strong></p>
<blockquote>
<div><p>IFS image to be processed.</p>
</div></blockquote>
<p><strong>PSFlet_tool: PSFLet instance</strong></p>
<blockquote>
<div><p>Inverse wavelength solution that is constructed during wavelength calibration</p>
</div></blockquote>
<p><strong>lamlist: list of floats</strong></p>
<blockquote>
<div><p>List of wavelengths to which each microspectrum is interpolated.</p>
</div></blockquote>
<p><strong>delt_y: int</strong></p>
<blockquote>
<div><p>Width in pixels of each microspectrum in the cross-dispersion direction</p>
</div></blockquote>
<p><strong>flat:</strong></p>
<blockquote>
<div><p>Whether a lenslet flatfield is used (not implemented yet)</p>
</div></blockquote>
<p><strong>smoothandmask: Boolean</strong></p>
<blockquote>
<div><p>Whether to smooth and mask bad pixels</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">image:  Image instance</p>
<blockquote class="last">
<div><p>Reduced cube in the image.data field</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.reduction.fitspec_intpix_np">
<code class="descclassname">tools.reduction.</code><code class="descname">fitspec_intpix_np</code><span class="sig-paren">(</span><em>par</em>, <em>im</em>, <em>PSFlet_tool</em>, <em>lamlist</em>, <em>smoothandmask=True</em>, <em>delt_y=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#fitspec_intpix_np"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.fitspec_intpix_np" title="Permalink to this definition">¶</a></dt>
<dd><p>Original optimal extraction routine in Numpy from T. Brand</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameter instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>im:     Image instance</strong></p>
<blockquote>
<div><p>IFS image to be processed.</p>
</div></blockquote>
<p><strong>PSFlet_tool: PSFLet instance</strong></p>
<blockquote>
<div><p>Inverse wavelength solution that is constructed during wavelength calibration</p>
</div></blockquote>
<p><strong>lamlist: list of floats</strong></p>
<blockquote>
<div><p>List of wavelengths to which each microspectrum is interpolated.</p>
</div></blockquote>
<p><strong>delt_y: int</strong></p>
<blockquote>
<div><p>Width in pixels of each microspectrum in the cross-dispersion direction</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">image:  Image instance</p>
<blockquote class="last">
<div><p>Reduced cube in the image.data field</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.reduction.fitspec_intpix_np_old">
<code class="descclassname">tools.reduction.</code><code class="descname">fitspec_intpix_np_old</code><span class="sig-paren">(</span><em>im</em>, <em>PSFlet_tool</em>, <em>lam</em>, <em>delt_x=7</em>, <em>header=SIMPLE  =                    T / conforms to FITS standard                       BITPIX  =                    8 / array data type                                 NAXIS   =                    0 / number of array dimensions                      EXTEND  =                    T</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#fitspec_intpix_np_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.fitspec_intpix_np_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.reduction.get_cutout">
<code class="descclassname">tools.reduction.</code><code class="descname">get_cutout</code><span class="sig-paren">(</span><em>im</em>, <em>x</em>, <em>y</em>, <em>psflets</em>, <em>dy=3</em>, <em>normpsflets=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#get_cutout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.get_cutout" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut out a microspectrum for fitting.  Return the inputs to
linalg.lstsq or to whatever regularization scheme we adopt.
Assumes that spectra are dispersed in the -y direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>im: Image intance</strong></p>
<blockquote>
<div><p>Image containing data to be fit</p>
</div></blockquote>
<p><strong>x: float</strong></p>
<blockquote>
<div><p>List of x centroids for each microspectrum</p>
</div></blockquote>
<p><strong>y: float</strong></p>
<blockquote>
<div><p>List of y centroids for each microspectrum</p>
</div></blockquote>
<p><strong>psflets: PSFLet instance</strong></p>
<blockquote>
<div><p>Typically generated from polychrome step in wavelength calibration routine</p>
</div></blockquote>
<p><strong>dy: int</strong></p>
<blockquote>
<div><p>vertical length to cut out, default 3.  This is the length to cut out in the
+/-y direction; the lengths cut out in the +x direction (beyond the shortest
and longest wavelengths) are also dy.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">subim:  2D array</p>
<blockquote>
<div><p>A flattened subimage to be fit</p>
</div></blockquote>
<p>psflet_subarr: 2D ndarray</p>
<blockquote class="last">
<div><p>first dimension is wavelength, second dimension is spatial, and is the same
shape as the flattened subimage.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Both subim and psflet_subarr are scaled by the inverse
standard deviation if it is given for the input Image.  This
will make the fit chi2 and properly handle bad/masked pixels.</p>
</dd></dl>

<dl class="function">
<dt id="tools.reduction.intOptimalExtract">
<code class="descclassname">tools.reduction.</code><code class="descname">intOptimalExtract</code><span class="sig-paren">(</span><em>par</em>, <em>name</em>, <em>IFSimage</em>, <em>smoothandmask=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#intOptimalExtract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.intOptimalExtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the optimal extraction routine</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameter instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>name: string</strong></p>
<blockquote>
<div><p>Path &amp; name of the output file</p>
</div></blockquote>
<p><strong>IFSimage: Image instance</strong></p>
<blockquote class="last">
<div><p>Image instance of input image. Can have a .ivar field for a variance map.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>A cube is also written at par.SimResults/name.fits</p>
</dd></dl>

<dl class="function">
<dt id="tools.reduction.lstsqExtract">
<code class="descclassname">tools.reduction.</code><code class="descname">lstsqExtract</code><span class="sig-paren">(</span><em>par</em>, <em>name</em>, <em>ifsimage</em>, <em>smoothandmask=True</em>, <em>ivar=True</em>, <em>dy=2</em>, <em>refine=False</em>, <em>hires=False</em>, <em>upsample=3</em>, <em>fitbkgnd=False</em>, <em>specialPolychrome=None</em>, <em>returnall=False</em>, <em>mode='lstsq'</em>, <em>niter=10</em>, <em>pixnoise=0.0</em>, <em>normpsflets=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#lstsqExtract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.lstsqExtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Least squares extraction, inspired by T. Brandt and making use of some of his code.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par:    Parameter instance</strong></p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>name: string</strong></p>
<blockquote>
<div><p>Name that will be given to final image, without fits extension</p>
</div></blockquote>
<p><strong>ifsimage: Image</strong></p>
<blockquote>
<div><p>Image instance of IFS detector map, with optional inverse variance</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cube</strong> :  3D array</p>
<blockquote class="last">
<div><p>Return the reduced cube from the original IFS image</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.reduction.testReduction">
<code class="descclassname">tools.reduction.</code><code class="descname">testReduction</code><span class="sig-paren">(</span><em>par</em>, <em>name</em>, <em>ifsimage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/reduction.html#testReduction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.reduction.testReduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Scratch routine to test various things.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par:    Parameter instance</strong></p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>name: string</strong></p>
<blockquote>
<div><p>Name that will be given to final image, without fits extension</p>
</div></blockquote>
<p><strong>ifsimage: Image instance of IFS detector map, with optional inverse variance</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cube</strong> :  3D array</p>
<blockquote class="last">
<div><p>Return the reduced cube from the original IFS image</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.rotate">
<span id="tools-rotate-module"></span><h2>tools.rotate module<a class="headerlink" href="#module-tools.rotate" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.rotate.Rotate">
<code class="descclassname">tools.rotate.</code><code class="descname">Rotate</code><span class="sig-paren">(</span><em>image</em>, <em>phi</em>, <em>clip=True</em>, <em>order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/rotate.html#Rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.rotate.Rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the input image by phi about its center.  Do not resize the
image, but pad with zeros.  Function originally from Tim Brandt</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>image</strong> : 2D square array</p>
<blockquote>
<div><p>Image to rotate</p>
</div></blockquote>
<p><strong>phi</strong> : float</p>
<blockquote>
<div><p>Rotation angle in radians</p>
</div></blockquote>
<p><strong>clip</strong> :  boolean (optional)</p>
<blockquote>
<div><p>Clip array by sqrt(2) to remove fill values?  Default True.</p>
</div></blockquote>
<p><strong>order</strong> : integer (optional)</p>
<blockquote>
<div><p>Order of interpolation when rotating. Default is 1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imageout: 2D array</p>
<blockquote class="last">
<div><p>Rotated image of the same shape as the input image, with zero-padding</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.rotate.Shift">
<code class="descclassname">tools.rotate.</code><code class="descname">Shift</code><span class="sig-paren">(</span><em>image</em>, <em>dx</em>, <em>dy</em>, <em>order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/rotate.html#Shift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.rotate.Shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the input image by dx, dy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>image</strong> : 2D square array</p>
<blockquote>
<div><p>Image to rotate</p>
</div></blockquote>
<p><strong>dx</strong> : float</p>
<blockquote>
<div><p>Rotation angle in radians</p>
</div></blockquote>
<p><strong>dy</strong> :  boolean (optional)</p>
<blockquote>
<div><p>Clip array by sqrt(2) to remove fill values?  Default True.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imageout: 2D array</p>
<blockquote class="last">
<div><p>Shifted image of the same shape as the input image</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The functions pads the edges with the nearest value, including NaNs.</p>
</dd></dl>

<dl class="function">
<dt id="tools.rotate.rotateCube">
<code class="descclassname">tools.rotate.</code><code class="descname">rotateCube</code><span class="sig-paren">(</span><em>cube</em>, <em>phi</em>, <em>clip=True</em>, <em>order=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/rotate.html#rotateCube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.rotate.rotateCube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.rotate.shiftCube">
<code class="descclassname">tools.rotate.</code><code class="descname">shiftCube</code><span class="sig-paren">(</span><em>cube</em>, <em>dx</em>, <em>dy</em>, <em>order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/rotate.html#shiftCube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.rotate.shiftCube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.spectrograph">
<span id="tools-spectrograph-module"></span><h2>tools.spectrograph module<a class="headerlink" href="#module-tools.spectrograph" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.spectrograph.createAllWeightsArray">
<code class="descclassname">tools.spectrograph.</code><code class="descname">createAllWeightsArray</code><span class="sig-paren">(</span><em>par</em>, <em>locations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/spectrograph.html#createAllWeightsArray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.spectrograph.createAllWeightsArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates weights for bilinear interpolation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameter instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>locations</strong> : 2D ndarray, Nx2</p>
<blockquote>
<div><p>Array of normalized locations on the detector, .</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>detectorFrame</strong> : 2D array</p>
<blockquote class="last">
<div><p>Return the detector frame with correct pixel scale.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.spectrograph.distort">
<code class="descclassname">tools.spectrograph.</code><code class="descname">distort</code><span class="sig-paren">(</span><em>fx</em>, <em>fy</em>, <em>lam</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/spectrograph.html#distort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.spectrograph.distort" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the distortion and dispersion from pre-determined polynomial
This was estimated from Zemax by Qian Gong and Jorge Llop and needs to be revisited</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fx,fy</strong> :   float</p>
<blockquote>
<div><p>Distance between a lenslet and the center of the detector in millimeter.</p>
</div></blockquote>
<p><strong>lam</strong> : float</p>
<blockquote>
<div><p>Wavelength in microns.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x,y</strong> : float</p>
<blockquote class="last">
<div><p>Distance from center of detector at which image from a lenslet falls in mm.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.spectrograph.loadKernels">
<code class="descclassname">tools.spectrograph.</code><code class="descname">loadKernels</code><span class="sig-paren">(</span><em>par</em>, <em>wavel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/spectrograph.html#loadKernels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.spectrograph.loadKernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the kernels that represent the PSFs at different locations on the detector</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameter instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>wavel</strong> : float</p>
<blockquote>
<div><p>Wavelength at which the kernels are needed</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kernels: array of 2D arrays</p>
<blockquote>
<div><p>Represents each 2D kernel at each location</p>
</div></blockquote>
<p>locations: Nx2 ndarray</p>
<blockquote class="last">
<div><p>Location coordinates in detector position ratio (0,0) is bottom left, (1,1) is
top right</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.spectrograph.selectKernel">
<code class="descclassname">tools.spectrograph.</code><code class="descname">selectKernel</code><span class="sig-paren">(</span><em>par</em>, <em>lam</em>, <em>refWaveList</em>, <em>kernelList</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/spectrograph.html#selectKernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.spectrograph.selectKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the correct kernel for the current wavlength</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameter instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>lam</strong> : float</p>
<blockquote>
<div><p>Wavelength at which we want the get the kernel, in microns</p>
</div></blockquote>
<p><strong>refWaveList</strong> : list of floats</p>
<blockquote>
<div><p>Wavelengths at which the kernels are defined</p>
</div></blockquote>
<p><strong>kernelList</strong> : list of 3D ndarrays</p>
<blockquote>
<div><p>List of the kernels cubes at the wavelengths above</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kernels: array of 2D arrays</p>
<blockquote>
<div><p>Represents each 2D kernel at each location for that wavlength</p>
</div></blockquote>
<p>locations: Nx2 ndarray</p>
<blockquote class="last">
<div><p>Location coordinates in detector position ratio (0,0) is bottom left, (1,1) is
top right</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.wavecal">
<span id="tools-wavecal-module"></span><h2>tools.wavecal module<a class="headerlink" href="#module-tools.wavecal" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tools.wavecal.buildcalibrations">
<code class="descclassname">tools.wavecal.</code><code class="descname">buildcalibrations</code><span class="sig-paren">(</span><em>par</em>, <em>filelist=None</em>, <em>lamlist=None</em>, <em>order=3</em>, <em>inspect=False</em>, <em>genwavelengthsol=False</em>, <em>makehiresPSFlets=False</em>, <em>makePolychrome=False</em>, <em>makehiresPolychrome=False</em>, <em>makePSFWidths=False</em>, <em>savehiresimages=True</em>, <em>borderpix=4</em>, <em>upsample=5</em>, <em>nsubarr=3</em>, <em>parallel=True</em>, <em>inspect_first=True</em>, <em>apodize=False</em>, <em>lamsol=None</em>, <em>threshold=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/wavecal.html#buildcalibrations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.wavecal.buildcalibrations" title="Permalink to this definition">¶</a></dt>
<dd><p>Master wavelength calibration function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>par</strong> :   Parameter instance</p>
<blockquote>
<div><p>Contains all IFS parameters</p>
</div></blockquote>
<p><strong>filelist: list of strings (optional)</strong></p>
<blockquote>
<div><p>List of the fits files that contain the monochromatic calibration files. If None (default),
use the files in par.filelist</p>
</div></blockquote>
<p><strong>lamlist: list of floats (optional)</strong></p>
<blockquote>
<div><p>Wavelengths in nm at which the files are taken. If None (default),
use the files in par.lamlist</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>Order of the polynomial used to fit the PSFLet positions across the detector</p>
</div></blockquote>
<p><strong>genwavelengthsol: Boolean</strong></p>
<blockquote>
<div><p>If True, generate the wavelength calibration. Creates a text file with all
polynomial coefficients that best fit the PSFLet positions at each wavelength.
If False, then load an already-generated file.</p>
</div></blockquote>
<p><strong>inspect: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to create PNG files that overlay PSFLet fitted position on the
monochromatic pictures, to visually inspect the fitting results</p>
</div></blockquote>
<p><strong>inspect_first: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to create a PNG file that overlays PSFLet fitted position on the
monochromatic picture of the first file, to visually inspect the fitting results</p>
</div></blockquote>
<p><strong>makehiresPSFlets: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to do a high-resolution fitting of the PSFs, using the sampling
diversity. This requires high-SNR monochromatic images.</p>
</div></blockquote>
<p><strong>makePolychrome: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to build the polychrome cube used in the least squares extraction</p>
</div></blockquote>
<p><strong>makePSFWidths: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to fit the PSFLet widths using the high-res PSFLets</p>
</div></blockquote>
<p><strong>makehiresPolychrome: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to build a polychrome cube at a high spatial resolution for future
subpixel interpolations</p>
</div></blockquote>
<p><strong>savehiresimages: Boolean</strong></p>
<blockquote>
<div><p>Whether to save fits files with the high-res PSFLets</p>
</div></blockquote>
<p><strong>borderpix:  int</strong></p>
<blockquote>
<div><p>Number of pixels that are not taken into account towards the edges of the detector</p>
</div></blockquote>
<p><strong>upsample: int</strong></p>
<blockquote>
<div><p>Upsampling factor for each high-resolution PSFLet</p>
</div></blockquote>
<p><strong>nsubarr: int</strong></p>
<blockquote>
<div><p>Detector will be divided into nsubarr x nsubarr regions. A high-resolution PSFLet
will be determined in each region from the average of all PSFLets within that
region</p>
</div></blockquote>
<p><strong>parallel: Boolean</strong></p>
<blockquote>
<div><p>Whether or not to parallelize the computation for the high-resolution PSFLet and
polychrome computation. The wavelength calibration step cannot be parallelized since
each wavelength uses the previous wavelength solution as a guess input.</p>
</div></blockquote>
<p><strong>apodize: Boolean</strong></p>
<blockquote>
<div><p>Whether to fit the spots only using lenslets within a circle, ignoring the corners of
the detector</p>
</div></blockquote>
<p><strong>lamsol: 2D array</strong></p>
<blockquote>
<div><p>Optional argument that, if not None and if genwavelengthsol==False, will take the argument
and use it as the current wavelength calibration to build the polychrome.</p>
</div></blockquote>
<p><strong>threshold: float</strong></p>
<blockquote class="last">
<div><p>Threshold under which to zero out the polychrome. This is only useful for reducing
the file size of the polychrome, and has only very little impact on the extraction.
To be safe, for science extractions threshold should be kept at its default value of 0.0</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function generates all the files required to process IFS cubes:
lamsol.dat: contains a list of the wavelengths and the polynomial coefficients that</p>
<blockquote>
<div>describe the X,Y positions of all lenslets on the detector as a function
of lenslet position on the lenslet array.</div></blockquote>
<dl class="docutils">
<dt>polychromekeyRXX.fits:  where XX is replaced by the spectral resolution defined in the</dt>
<dd>parameters file. This is a multi-extension fits file with:
- a list of the central wavelengths at which the final cube will be reduced to
- an array of the X positions of all lenslets
- an array of the Y positions of all lenslets
- an array of booleans indicating whether that lenslet is good or not
(e.g. when it is outside of the detector area)</dd>
<dt>polychromeRXX.fits: 3D arrays of size Nspec x Npix x Npix with maps of the PSFLets put in their correct</dt>
<dd>positions for each wavelength bins that we want in the output cube. Each PSFLet
in each wavelength slice is used for least-squares fitting.</dd>
</dl>
<p>hiresPolychromeRXX.fits: same as polychromeRXX.fits but this time using the high-resolution PSFLets
PSFLoc.fits:    nsubarr x nsubarr array of 2D high-resolution PSFLets at each location</p>
<blockquote>
<div>in the detector.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="tools.wavecal.do_inspection">
<code class="descclassname">tools.wavecal.</code><code class="descname">do_inspection</code><span class="sig-paren">(</span><em>par</em>, <em>image</em>, <em>xpos</em>, <em>ypos</em>, <em>lam</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/wavecal.html#do_inspection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.wavecal.do_inspection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.wavecal.get_sim_hires">
<code class="descclassname">tools.wavecal.</code><code class="descname">get_sim_hires</code><span class="sig-paren">(</span><em>par</em>, <em>lam</em>, <em>upsample=10</em>, <em>nsubarr=1</em>, <em>npix=13</em>, <em>renorm=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/wavecal.html#get_sim_hires"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.wavecal.get_sim_hires" title="Permalink to this definition">¶</a></dt>
<dd><p>Build high resolution images of the undersampled PSF using the
monochromatic frames. This version of the function uses the perfect
knowledge of the Gaussian PSFLet. Only valid if par.gaussian=True.
All PSFLets are the same across the entire FOV</p>
</dd></dl>

<dl class="function">
<dt id="tools.wavecal.gethires">
<code class="descclassname">tools.wavecal.</code><code class="descname">gethires</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>good</em>, <em>image</em>, <em>upsample=5</em>, <em>nsubarr=5</em>, <em>npix=13</em>, <em>renorm=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/wavecal.html#gethires"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.wavecal.gethires" title="Permalink to this definition">¶</a></dt>
<dd><p>Build high resolution images of the undersampled PSF using the
monochromatic frames.</p>
<p>Inputs:
1.</p>
</dd></dl>

<dl class="function">
<dt id="tools.wavecal.makeHires">
<code class="descclassname">tools.wavecal.</code><code class="descname">makeHires</code><span class="sig-paren">(</span><em>par</em>, <em>xindx</em>, <em>yindx</em>, <em>lam</em>, <em>allcoef</em>, <em>psftool</em>, <em>imlist=None</em>, <em>parallel=True</em>, <em>savehiresimages=True</em>, <em>upsample=5</em>, <em>nsubarr=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/wavecal.html#makeHires"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.wavecal.makeHires" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct high-resolution PSFLets</p>
</dd></dl>

<dl class="function">
<dt id="tools.wavecal.make_hires_polychrome">
<code class="descclassname">tools.wavecal.</code><code class="descname">make_hires_polychrome</code><span class="sig-paren">(</span><em>lam1</em>, <em>lam2</em>, <em>hires_arrs</em>, <em>lam_arr</em>, <em>psftool</em>, <em>allcoef</em>, <em>xindx</em>, <em>yindx</em>, <em>ydim</em>, <em>xdim</em>, <em>upsample=10</em>, <em>nlam=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/wavecal.html#make_hires_polychrome"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.wavecal.make_hires_polychrome" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.wavecal.make_polychrome">
<code class="descclassname">tools.wavecal.</code><code class="descname">make_polychrome</code><span class="sig-paren">(</span><em>lam1</em>, <em>lam2</em>, <em>hires_arrs</em>, <em>lam_arr</em>, <em>psftool</em>, <em>allcoef</em>, <em>xindx</em>, <em>yindx</em>, <em>ydim</em>, <em>xdim</em>, <em>upsample=10</em>, <em>nlam=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/wavecal.html#make_polychrome"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.wavecal.make_polychrome" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.wavecal.monochromatic_update">
<code class="descclassname">tools.wavecal.</code><code class="descname">monochromatic_update</code><span class="sig-paren">(</span><em>par</em>, <em>inImage</em>, <em>inLam</em>, <em>order=3</em>, <em>apodize=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tools/wavecal.html#monochromatic_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tools.wavecal.monochromatic_update" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: also update polychrome when specified</p>
</dd></dl>

</div>
<div class="section" id="module-tools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-tools" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">tools package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-tools.detector">tools.detector module</a></li>
<li><a class="reference internal" href="#module-tools.detutils">tools.detutils module</a></li>
<li><a class="reference internal" href="#module-tools.image">tools.image module</a></li>
<li><a class="reference internal" href="#module-tools.imgtools">tools.imgtools module</a></li>
<li><a class="reference internal" href="#module-tools.initLogger">tools.initLogger module</a></li>
<li><a class="reference internal" href="#module-tools.inputScene">tools.inputScene module</a></li>
<li><a class="reference internal" href="#module-tools.lenslet">tools.lenslet module</a></li>
<li><a class="reference internal" href="#module-tools.locate_psflets">tools.locate_psflets module</a></li>
<li><a class="reference internal" href="#module-tools.par_utils">tools.par_utils module</a></li>
<li><a class="reference internal" href="#module-tools.plotting">tools.plotting module</a></li>
<li><a class="reference internal" href="#module-tools.postprocessing">tools.postprocessing module</a></li>
<li><a class="reference internal" href="#module-tools.reduction">tools.reduction module</a></li>
<li><a class="reference internal" href="#module-tools.rotate">tools.rotate module</a></li>
<li><a class="reference internal" href="#module-tools.spectrograph">tools.spectrograph module</a></li>
<li><a class="reference internal" href="#module-tools.wavecal">tools.wavecal module</a></li>
<li><a class="reference internal" href="#module-tools">Module contents</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="_sources/tools.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2017, Maxime J. Rizzo.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3. &nbsp;
    Last built 02 Mar 2018. <br/>
  </p>
</footer>
  </body>
</html>